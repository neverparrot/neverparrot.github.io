<html>
<head>
<style>

</style>
<script>
</script>
<meta charset='UTF-8' />
<link rel='icon' type='image/png' sizes='128x128' href='../../../../static/favicon-128x128.png' />
<link rel='icon' type='image/png' sizes='64x64' href='../../../../static/favicon-64x64.png' />
<link rel='icon' type='image/png' sizes='32x32' href='../../../../static/favicon-32x32.png' />
<link rel='icon' type='image/png' sizes='16x16' href='../../../../static/favicon-16x16.png' />
<link rel='icon' type='image/x-icon' sizes='48x48 32x32 16x16' href='../../../../static/favicon.ico' />

<link href='../../../../static/main2.css' rel='stylesheet' type='text/css' />
<title>Противопопугайный сайт / Never Parrot</title>
</head>
<body>


<div class='box_post'>

<span>
  <a href='../../../../index.html'><img src='../../../../static/logo.jpg' alt='busted parrot' align='top' class='top_l_img' /></a>

<ul style='display: inline-block;'>
  <li style='display:inline;font-size: 2.0em;'>Противопопугайный сайт</li>
  <li style='display:inline;font-size: 1.0em;'><div>Never Parrot</div></li>
</ul>


</span>

<span id='nav' class='top_r'>
  
  <div style='display: inline-block;' align='top'>
   <a href='../../../../index.html'>
      <div class='dipper_navig'>
         <img src='../../../../static/ornaments/main.svg' alt='main' align='top' class='dipper_nav_img' title='на главную / to main page' />
      </div>
   </a>
  </div>
  <div style='display: inline-block;' align='top'>
    <a href='../../../../archive2.html#post85'>
    <div class='dipper_navig'>
      <img src='../../../../static/ornaments/archivePage.svg' alt='archive' align='top' class='dipper_nav_img' title='в архив / to archive' />
    </div>
    </a>
  </div>
  
  <div style='display: inline-block;' align='top'>
   <a href='../../../../ind/static/ornaments/site_programming_logo_1.html#post85'>
      <div class='dipper_navig'>
         <img src='../../../../static/nav_parent.svg' alt='parent' align='top' class='dipper_nav_img' title='обратно к выбору / to selection' />
      </div>
   </a>
  </div>
  
<!--a href="${parent______url}"><div class="to_parent">↰</div></a-->

  <div style='display: inline-block;' align='top'>
   <a href='post86.html'>
      <div class='dipper_navig'>
         <img src='../../../../static/dipper_prev.svg' alt='previous' align='top' class='dipper_nav_img' />
      

      </div>
   </a>
  </div>



  <div style='display: inline-block;' align='top'>
   <a href='post81.html'>
      <div class='dipper_navig'>
         <img src='../../../../static/dipper_next.svg' alt='next' align='top' class='dipper_nav_img' />
      

      </div>
   </a>
  </div>



  
</span>

</div>





<div align='center'>
<div style='max-width:120em;'>
<div class='post_hf' align='left'>
<div id='post85' align='left'>

   <div style='position:absolute; z-index:1;'>
      <object type='image/svg+xml' data='../../../../static/ornaments/site_programming_logo.svg' style='width:auto; height:5em; opacity: 0.5;'></object>
   </div>

   <div style='position:relative; z-index:2;'>

     <div>
      Для справки <s>идиотам</s> большим оригиналам которые используют <a href='../../../../static/htic.js'>htic.js</a> кроме меня: туда добавилась возможность запускать сторонние javascript функции и выполнять переходы относительно указанного узла.
     </div>

     <div style='margin-top:1em;'>
      If there are <s>idiots</s> unique people like me that use <a href='../../../../static/htic.js'>htic.js</a> be advised: the option to run external javascript functions has been added and also the ability to set transitions relative to a given node.
     </div>


   </div>

</div>
<div style='margin-top: 1em;'>
  <div>
    <div class='post_text_ru'>
      <span style='display:inline-block;width:2em;'></span>За примером далеко ходить не надо, в меню "У меня есть" на главной странице используется 2 runCode узла. Они отвечают за размер меню в зависимости от ширины экрана.
    </div>
    <div class='post_text_en'>
      <span style='display:inline-block;width:2em;'></span>For example you don't have to look further then the main page "Checkitout" menu. It uses 2 runCode nodes for managing menu size depending on screen width.
    </div>

  </div>

  
  
  <div align='center' style='margin-top: 1em;'>

    <a href='../../../../static/fodgTohtic/neverParrotMain2_runCode.svg'>
      <div style='background: url(../../../../static/fodgTohtic/neverParrotMain2_runCode.svg);height: 20em;width: 40em;background-repeat: no-repeat;background-position: center;background-size: contain;display: inline-block;max-width: 90%;margin: 0.5em;max-height: 90vw;'>
      </div>
    </a>
    <div>
      Вот картинка для тех кому лень открывать 
      <a href='https://github.com/Collocalini/bustedParrot/blob/51e8db11d5a30b381f8507b5e4e88a11d2ec6367/bustedParrot/htic/neverParrotMain.fodg'>
        neverParrotMain.fodg 
      </a>
      самому.
    </div>
    <div style='margin-bottom: 1em;'>
      Here's the picture for people who can't be bothered to open 
      <a href='https://github.com/Collocalini/bustedParrot/blob/51e8db11d5a30b381f8507b5e4e88a11d2ec6367/bustedParrot/htic/neverParrotMain.fodg'>
        neverParrotMain.fodg 
      </a>
      themselves.
    </div>
    
    <a href='../../../../static/fodgTohtic/Screenshot_2024-06-21_23-33-58.png'>
      <div style='background: url(../../../../static/fodgTohtic/Screenshot_2024-06-21_23-33-58.png);height: 20em;width: 40em;background-repeat: no-repeat;background-position: center;background-size: contain;display: inline-block;max-width: 90%;margin: 0.5em;max-height: 90vw;'>
      </div>
    </a>
    <div>
      Если вы всё-таки захотите попробовать сами, не забывайте что все узлы должны быть подписаны в title, иначе не заработает. Для runCode узла нужно вписать "runCode", внезапно, да.
    </div>
    <div style='margin-bottom: 1em;'>
      If for any reason you decide to give it a go yourselve remember that all nodes should have their type put into the title field or it won't work. For runCode node you should put in "runCode", duh.
    </div>
    
    
    <a href='../../../../static/fodgTohtic/testOverrideNext.svg'>
      <div style='background: url(../../../../static/fodgTohtic/testOverrideNext.svg);height: 30em;width: 60em;background-repeat: no-repeat;background-position: center;background-size: contain;display: inline-block;max-width: 90%;margin: 0.5em;max-height: 90vw;'>
      </div>
    </a>
    <div>
      Файл neverParrotMain.fodg большой, учиться использовать overrideNext будем на <s>кошках</s> примере поменьше.
    </div>
    <div>
      The file neverParrotMain.fodg is big so let me introduce todays <s>victim</s> visual aid for overrideNext usage tutorial.
    </div>
    <div>
      <a href='../../../../static/fodgTohtic/testOverrideNext.xml'>
        testOverrideNext.fodg
      </a>
    </div>
    
  </div>

<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Neocities не даёт мне сохранить файл с расширением *.fodg поэтому вам придётся скачать testOverrideNext.xml и поменять расширение. Заметьте что я даже не вру что testOverrideNext.xml это XML, flat-ODG это правда XML, в него просто сохраняется диаграмма в XML формате, а не просто любая информация в XML формате как в файлы с *.xml расширением. Любая информация в XML формате включает в себя диаграммы в XML формате.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>Neocities doesn't let me save a file with *.fodg extention so you would have to download testOverrideNext.xml and rename it. For your information I'm not even lying about testOverrideNext.xml being XML, flat-ODG is actually XML, but for storing diagrams in XML format as opposed to storing any sort of information in XML format in a file with an *.xml extention. Any information in XML format includes diagrams in XML format.
</div>

<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Помимо fodg нам понадобится html шаблон 
  <a href='../../../../static/fodgTohtic/tmpE5.html'>
    tmpE5.html
  </a>
  . В него сохранена копия htic.js, так как я хочу приколотить гвоздями версию библиотеки, а основная версия на сайте будет обновляться в будущем. Но помимо htic.js в него сохранены ещё дополнительные функции, я выделил представляющие особый интерес.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>But besides fodg we would also need an html template 
  <a href='../../../../static/fodgTohtic/tmpE5.html'>
    tmpE5.html
  </a>
  . It contains a separate copy of htic.js because I want to nail down the version of that and the main copy of htic.js on this site will be updated in the future. But besides htic.js there are several more functions of note stored there.
</div>




<div class='post_text_code_outer'>
  <div class='post_text_code_line_num'>
     1 <br />
     2 <br />
     3 <br />
     4 <br />
     5 <br />
     6 <br />
     7 <br />
     8 <br />
     9 <br />
    10 <br />
    11 <br />
    12 <br />
    13 <br />
    14 <br />
    15 <br />
    16 <br />
    17 <br />
    18 <br />
    19 <br />
    20 <br />
    21 <br />
    22 <br />
    23 <br />
    24 <br />
    25 <br />
    26 <br />
    27 <br />
    28 <br />
    29 <br />
    30 <br />
    31 <br />
    32 <br />
    33 <br />
    34 <br />
    35 <br />
    36 <br />
    37 <br />
    38 <br />
    39 <br />
    40 <br />
    41 <br />
    42 <br />
    43 <br />
    44 <br />
    45 <br />
    46 <br />
    47 <br />
    48 <br />
    49 <br />
    50 <br />
    51 <br />
    52 <br />
    53 <br />
    54 <br />
    55 <br />
    56 <br />
    57 <br />
    
  </div>
  <div class='post_text_code_inner'>
    <div>
       <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>replaceInnerHtmlIfHasGivenValueAttr</span><span>(</span><span>name</span><span>,</span><span>repl</span><span>,</span><span>node</span><span>){</span><br />
        <span style='color: brown; font-weight: bold;'>var </span><span>n </span><span>= </span><span>node</span><span>;</span><br />
        <span style='color: brown; font-weight: bold;'>if</span><span>(</span><span>node</span><span>.</span><span>getAttribute</span><span>(</span><span style='color: fuchsia;'>"value"</span><span>)==</span><span>name</span><span>){</span><br />
          <span>n</span><span>.</span><span>innerHTML </span><span>= </span><span>repl</span><span>;</span><br />
        <span>}</span><br />
        <span style='color: brown; font-weight: bold;'>return </span><span>n</span><span>;</span><br />
      <span>}</span><br />
      <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>setOverrideNextToThisBranch_</span><span>(</span><span>e</span><span>,</span><span>v</span><span>){</span><br />
      <br />
        <span style='color: brown; font-weight: bold;'>var </span><span>branchName </span><span>= </span><span>e</span><span>.</span><span>target</span><span>.</span><span>parentNode</span><span>.</span><span>getAttribute</span><span>(</span><span style='color: fuchsia;'>"value"</span><span>).</span><span>split</span><span>(</span><span style='color: fuchsia;'>"option_"</span><span>)[</span><span>1</span><span>];</span><br />
      <br />
        <span>([].</span><span>slice</span><span>.</span><span>call</span><span>(</span><span>document</span><span>.</span><span>getElementById</span><span>(</span><span style='color: fuchsia;'>"cache"</span><span>).</span><span>children</span><span>)).</span><span>map</span><span>(</span><span style='color: brown; font-weight: bold;'>function</span><span>(</span><span>n</span><span>){</span><br />
          <span style='color: brown; font-weight: bold;'>return </span><span>replaceInnerHtmlIfHasGivenValueAttr</span><span>(</span><span>v</span><br />
            <span>,</span><span style='color: fuchsia;'>"&lt;param value=\"" </span><span>+ </span><span>branchName </span><span>+ </span><span style='color: fuchsia;'>"\"&gt;"</span><br />
            <span>,</span><span>n</span><br />
            <span>);</span><br />
          <span>}</span><br />
          <span>);</span><br />
      <span>}</span><br />
      <br />
      <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>setOverrideNextToThisBranchString</span><span>(</span><span>branchName</span><span>,</span><span>v</span><span>){</span><br />
        <span>([].</span><span>slice</span><span>.</span><span>call</span><span>(</span><span>document</span><span>.</span><span>getElementById</span><span>(</span><span style='color: fuchsia;'>"cache"</span><span>).</span><span>children</span><span>)).</span><span>map</span><span>(</span><span style='color: brown; font-weight: bold;'>function</span><span>(</span><span>n</span><span>){</span><br />
          <span style='color: brown; font-weight: bold;'>return </span><span>replaceInnerHtmlIfHasGivenValueAttr</span><span>(</span><span>v</span><br />
            <span>,</span><span style='color: fuchsia;'>"&lt;param value=\"" </span><span>+ </span><span>branchName </span><span>+ </span><span style='color: fuchsia;'>"\"&gt;"</span><br />
            <span>,</span><span>n</span><br />
            <span>);</span><br />
          <span>}</span><br />
          <span>);</span><br />
      <span>}</span><br />
      <br />
      <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>clearOverrideNext1</span><span>(</span><span>e</span><span>){</span><br />
        <span>clearOverrideNext_</span><span>(</span><span>e</span><span>,</span><span style='color: fuchsia;'>"overrideNxt1"</span><span>);</span><br />
      <span>}</span><br />
      <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>clearOverrideNext_</span><span>(</span><span>e</span><span>,</span><span>v</span><span>){</span><br />
        <span>([].</span><span>slice</span><span>.</span><span>call</span><span>(</span><span>document</span><span>.</span><span>getElementById</span><span>(</span><span style='color: fuchsia;'>"cache"</span><span>).</span><span>children</span><span>)).</span><span>map</span><span>(</span><span style='color: brown; font-weight: bold;'>function</span><span>(</span><span>n</span><span>){</span><br />
          <span style='color: brown; font-weight: bold;'>return </span><span>replaceInnerHtmlIfHasGivenValueAttr</span><span>(</span><span>v</span><span>,</span><span style='color: fuchsia;'>""</span><span>,</span><span>n</span><span>);</span><br />
          <span>}</span><br />
          <span>);</span><br />
      <br />
      <span>}</span><br />
      <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>autostart</span><span>(</span><span>e</span><span>){</span><br />
        <span>document</span><span>.</span><span>getElementById</span><span>(</span><span style='color: fuchsia;'>"display"</span><span>).</span><span>children</span><span>[</span><span>1</span><span>].</span><span>children</span><span>[</span><span>0</span><span>].</span><span>click</span><span>();</span><br />
      <span>}</span><br />
      <br />
      <span>window</span><span>.</span><span>addEventListener</span><span>(</span><span>'load'</span><span>, </span><span>autostart</span><span>, </span><span style='color: brown; font-weight: bold;'>false</span><span>);</span><br />
         <br />
      <br />
      <span style='color: brown; font-weight: bold;'>function </span><span>runCode</span><span>(</span><span>c</span><span>){</span><br />
        <span style='color: brown; font-weight: bold;'>var </span><span>a</span><span>=</span><span style='color: brown; font-weight: bold;'>new </span><span style='color: brown; font-weight: bold;'>Function</span><span>(</span><span>c</span><span>);</span><br />
        <span>a</span><span>.</span><span>apply</span><span>(</span><span style='color: brown; font-weight: bold;'>null</span><span>);</span><br />
      <span>}</span><br />
      
      
    </div>
  </div>
  
</div>





<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Не <span style='font-size: 2em;'>обращайте внимание</span> на autostart, это просто небольшой костыль к которому мне пришлось прибегнуть.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>The autostart function is a little crutch I had to resort to. <span style='font-size: 2em;'>Ignore it</span>.
</div>
<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Функция runCode нужна для запуска стороннего кода библиотекой htic.js. Теоретически можно сделать её не обязательной, но я не сделал.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>The runCode function is there to let htic.js run external functions. It's not realy necessary and in theory I could do without it. In theory.
</div>
<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Функция setOverrideNextToThisBranch_(e,v), и остальные похожие, позволяют устанавливать указатель для overrideNext при помощи события onclick. Но ими нельзя пользоваться если элемент с "option_&lt id &gt" не является непосредственным родителем элемента породившего событие onclick. В приводимом примере это условие не соблюдается.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>The function setOverrideNextToThisBranch_(e,v) and alike allow you to set overrideNext pointer using an onclick event. But it can only be used if the element with "option_&lt id &gt" is an immediate parent of the element triggering the onclick event. The provided example does not satisfy this condition.
</div>
<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Функция clearOverrideNext_(e,v) стирает установленый указатель. Ёе варианты без переменной v нужны потому что я не хотел писать лишние лямбды.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>The clearOverrideNext_(e,v) function erases the overrideNext pointer. There are versions of it without the v argument because I didn't like to write extra lambda-expressions.
</div>
<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Наконец 
  <p style='overflow-x: auto;max-width: 95%;'>
    <span style='display:inline-block;width:2em;'></span>setOverrideNextToThisBranchString(branchName,v) 
  </p>
  это функция использующаяся в примере для установки указателя overrideNext. Обратите внимание, что на момент создания fodg невозможно знать id узла-ветки на который должен быть установлен указатель, а значит параметр branchName не может быть заполнен. Однако hticExt заполнит этот параметр вместо нас на этапе сбороки html. Для этого в Description узла runCode нужно вписать какая подстрока текста в runCode должна быть заменена на искомый id. В приведённом примере это "branchName", таким образом текст 
  <p style='overflow-x: auto;max-width: 95%;'>
    <span style='display:inline-block;width:2em;'></span>setOverrideNextToThisBranchString("branchName","overrideNxt1")
  </p>
   будет заменён на 
  <p style='overflow-x: auto;max-width: 95%;'>
   <span style='display:inline-block;width:2em;'></span>setOverrideNextToThisBranchString("id1id2","overrideNxt1")
  </p>
   , где "id1id2" это произвольное значение призванное иллюстрировать id узла-ветки на который указывает нулевой переход на следующий узел-ветку (переходы считаются начиная с 0) относительно узла-ветки к которому привязан runCode. 
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>Finally
  <p style='overflow-x: auto;max-width: 95%;'>
    <span style='display:inline-block;width:2em;'></span>setOverrideNextToThisBranchString(branchName,v) 
  </p>
   is a function that was used in the given example to set the overrideNext pointer. Do note that at the time of fodg creation it is impossible to know the id of the branch-node the pointer is supposed to be set to, which means that the value of the branchName argument can not be provided. This conundrum is solved by hticExt that provides value for us during html assembly. To do that hticExt looks into the Description of the runCode-node for the substring it should search for in the text of the runCode-node to replace it with the appropriate id value. In the given example the substring is "branchName" so
  <p style='overflow-x: auto;max-width: 95%;'>
    <span style='display:inline-block;width:2em;'></span>setOverrideNextToThisBranchString("branchName","overrideNxt1") 
  </p>
   would be turned into 
  <p style='overflow-x: auto;max-width: 95%;'>
    <span style='display:inline-block;width:2em;'></span>setOverrideNextToThisBranchString("id1id2","overrideNxt1")
  </p>
    where "id1id2" is some arbitrary value that was used to illustrate the id of a branch-node that the number 0 transition points to (transitions are counted starting with 0) relative to the branch-node the runCode belongs to.
</div>
<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Рассмотрим алгоритм работы узла overrideNext. У каждого узла-ветки есть набор переходов на другие узлы-ветки. В отсутствии узлов-модификаторов, к которым относится overrideNext этот набор остаётся неизменным. Однако в присутствии модификатора overrideNext выполняется проверка наличия установленного указателя, имя которого записано в текст узла overrideNext. В представленном примере проверяется установка указателя(переменной) "overrideNxt1". В случае если указатель установлен, прочитывается Description узла overrideNext, и набор переходов узла-ветки, к которой прикреплён overrideNext, заменяется на переход, путь к которому указан в Description. Путь в Description указывается относительно узла на который установлен указатель.
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>Let's inspect the algorithm of an overrideNext node operation. Each branch-node possesses a set of transition options to other branch-nodes. In absence of modificator-nodes such as overrideNext the given set of transition options remains constant. But when an overrideNext node is assigned to a branch-node a check is performed. In case the pointer the overrideNext text specifies is set("overrideNxt1" in the given example), the set of transition options is replaced with the transition that the path stored in the overrideNext Description points to. The path is given relative to the branch-node the overrideNext pointer dictates.
</div>
<div class='post_text_ru' style='margin-top: 1em;'>
  <span style='display:inline-block;width:2em;'></span>Сборка html файла выполняется стандартным способом. Файл 
  <a href='../../../../static/fodgTohtic/testOverrideNext.json'>
    testOverrideNext.json 
  </a>
  содержит необходимые настройки для получения 
  <a href='../../../../static/fodgTohtic/testOverrideNext.html'>
    testOverrideNext.html
  </a>
  . Описание остальных узлов можно прочитать в предыдущей 
  <a href='../../../../post78.html'>
    публикации
  </a>
  .
</div>
<div class='post_text_en'>
  <span style='display:inline-block;width:2em;'></span>The html assembly can be done the standard way. The file
  <a href='../../../../static/fodgTohtic/testOverrideNext.json'>
    testOverrideNext.json 
  </a>
  contains the settings necessary to produce
  <a href='../../../../static/fodgTohtic/testOverrideNext.html'>
    testOverrideNext.html
  </a>
  . To read the description of the rest of the node-types refere to the previous 
  <a href='../../../../post78.html'>
  publication
  </a>
  .
</div>
<p style='overflow-x: auto;max-width: 95%;'>
  <span style='display:inline-block;width:2em;'></span>hticExt testOverrideNext.json &gt; testOverrideNext.log
</p>



  
</div>

</div>
</div>
</div>

<a href='post85.html#nav'><div class='to_nav_r'>↑</div></a>

</body>
</html>
