<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    
   <style>
      .otherPage {
         margin :0.05em;
         border:none;
      }
      
      .currentPage {

         border:0.1em solid;
      }
      
      .editOptionName {
         display:block;
         font-size:1em;
         margin-top:1em;
      }
      .editOptionDisplay {
         display:block;
         font-size:0.7em;
      }
      
      .option{
         margin:0.25em;
         background:lightgrey;
      }
      .option:hover{
         border-left:solid;
      }
    </style>
    <!--script type="text/javascript" src="htic.js"></script-->
  </head>
  <body>
     
     <div hidden="true" id="pagesTop" style="margin:2em;overflow-wrap: break-word;"></div>
     <div id="display"></div>
     <div hidden="true" id="pagesBottom" style="margin:2em;overflow-wrap: break-word;"></div>
     <div>
        <a hidden="true" style="margin:1em" id="save" onclick="savePage()" download="save.html" href="data:text/html;charset=UTF-8,">скачать сохранение / download game save</a>
        <a hidden="true" style="margin:1em" id="clearHistory">Clear history</a>
        <a hidden="true" style="margin:1em" id="updateFromDisplay">Update from display</a>
        <a hidden="true" style="margin:1em" id="edit">Edit</a>
        <a hidden="true" style="margin:1em" id="cancel"></a>
        
        <div hidden="true">Keep old<input checked="true" style="margin-left:1em" id="editKeepOld" type="checkbox"></div>
        <div hidden="true">Redirect links to new name<input style="margin-left:1em" id="editRedirectLinks" type="checkbox"></div>
        <button id="editDelete" hidden="true">Delete branch</button>
        <div hidden="true">Remove links<input style="margin-left:1em" id="editRemoveLinks" type="checkbox"></div>
        <button id="editListBranches" hidden="true">List all branches</button>
     </div>
      
     <div id="listOfAllBranches"></div>
     
     <data id="cache" hidden="true">
         <data id="pages"></data>
         <data value="overrideNxt1">
            
         </data>
         <data value="overrideNxt2">
            
         </data>
     </data>
     <data id="settings" hidden="true">
         <data value="newPageThreshold">100</data>
         <data value="scrollIntoView">1</data>
     </data>
     <data id="data" hidden="true"></data>
  
         

<script>
      <!--
        
function savePage() {
   var anchor = document.getElementById("save");
   var h = document.documentElement.outerHTML;
   anchor.setAttribute('download', 'save.html');
   anchor.setAttribute('href', 'data:text/html;charset=UTF-8,' + encodeURIComponent(h));
   }
function randomItem(items) { 
   return items[Math.floor((items.length * Math.random()))];
   }
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}   
 
function myF(e){
   alert("myF " + e.target.innerHTML);
}

function replaceInnerHtmlIfHasGivenValueAttr(name,repl,node){
  var n = node;
  //console.log('node: ', n.outerHTML);
  if(node.getAttribute("value")==name){
    n.innerHTML = repl;
    //alert("replacing " + name);
  }
  
  return n;

}

function setOverrideNextToThisBranch(e){
  setOverrideNextToThisBranch_(e,"overrideNxt1");
}
function setOverrideNextToThisBranch1(e){
  setOverrideNextToThisBranch_(e,"overrideNxt1");
}

function setOverrideNextToThisBranchString(branchName,v){
  ([].slice.call(document.getElementById("cache").children)).map(function(n){
    return replaceInnerHtmlIfHasGivenValueAttr(v
      ,"<param value=\"" + branchName + "\">"
      ,n
      );
    }
    );
}

function setOverrideNextToThisBranch2(e){
  setOverrideNextToThisBranch_(e,"overrideNxt2");
}

function setOverrideNextToThisBranch_(e,v){

  var branchName = e.target.parentNode.getAttribute("value").split("option_")[1];

  ([].slice.call(document.getElementById("cache").children)).map(function(n){
    return replaceInnerHtmlIfHasGivenValueAttr(v
      ,"<param value=\"" + branchName + "\">"
      ,n
      );
    }
    );

}




function clearOverrideNext(e){
  clearOverrideNext_(e,"overrideNxt1");
  clearOverrideNext_(e,"overrideNxt2");
}
function clearOverrideNext1(e){
  clearOverrideNext_(e,"overrideNxt1");
}
function clearOverrideNext2(e){
  clearOverrideNext_(e,"overrideNxt2");
}

function clearOverrideNext_(e,v){
  //alert("myF " + e.target.innerHTML);
  //alert("ThisBranch " + );
  //document.getElementById("cache").children = 
  ([].slice.call(document.getElementById("cache").children)).map(function(n){
    return replaceInnerHtmlIfHasGivenValueAttr(v,"",n);
    }
    );

}
function setHiddenById(id,v){
  document.getElementById(id).hidden = v;
}

function setHiddenToSaveAndPages(v){
  setHiddenById("save",v);
  setHiddenById("pagesTop",v);
  setHiddenById("pagesBottom",v);
}

function autostart(e){
  //alert("autostart ");
  document.getElementById("display").children[1].children[0].click();
}

//window.addEventListener('load', autostart, false);
   
    //-->
function runCode(c){
  var a=new Function(c);
  a.apply(null);
}








/*******************************************************************************
 * Misc.
 */


// Workaround for missing functionality in IE 8 and earlier.
if( Object.create === undefined ) {
  Object.create = function( o ) {
    function F(){}
    F.prototype = o;
    return new F();
  };
}

// Insert properties of b in place into a.
function Fay$$objConcat(a,b){
  for (var p in b) if (b.hasOwnProperty(p)){
    a[p] = b[p];
  }
  return a;
}

/*******************************************************************************
 * Thunks.
 */

// Force a thunk (if it is a thunk) until WHNF.
function Fay$$_(thunkish,nocache){
  while (thunkish instanceof Fay$$$) {
    thunkish = thunkish.force(nocache);
  }
  return thunkish;
}

// Apply a function to arguments (see method2 in Fay.hs).
function Fay$$__(){
  var f = arguments[0];
  for (var i = 1, len = arguments.length; i < len; i++) {
    f = (f instanceof Fay$$$? Fay$$_(f) : f)(arguments[i]);
  }
  return f;
}

// Thunk object.
function Fay$$$(value){
  this.forced = false;
  this.value = value;
}

// Force the thunk.
Fay$$$.prototype.force = function(nocache) {
  return nocache ?
    this.value() :
    (this.forced ?
     this.value :
     (this.value = this.value(), this.forced = true, this.value));
};


function Fay$$seq(x) {
  return function(y) {
    Fay$$_(x,false);
    return y;
  }
}

function Fay$$seq$36$uncurried(x,y) {
  Fay$$_(x,false);
  return y;
}

/*******************************************************************************
 * Monad.
 */

function Fay$$Monad(value){
  this.value = value;
}

// This is used directly from Fay, but can be rebound or shadowed. See primOps in Types.hs.
// >>
function Fay$$then(a){
  return function(b){
    return Fay$$bind(a)(function(_){
      return b;
    });
  };
}

// This is used directly from Fay, but can be rebound or shadowed. See primOps in Types.hs.
// >>
function Fay$$then$36$uncurried(a,b){
  return Fay$$bind$36$uncurried(a,function(_){ return b; });
}

// >>=
// This is used directly from Fay, but can be rebound or shadowed. See primOps in Types.hs.
function Fay$$bind(m){
  return function(f){
    return new Fay$$$(function(){
      var monad = Fay$$_(m,true);
      return Fay$$_(f)(monad.value);
    });
  };
}

// >>=
// This is used directly from Fay, but can be rebound or shadowed. See primOps in Types.hs.
function Fay$$bind$36$uncurried(m,f){
  return new Fay$$$(function(){
    var monad = Fay$$_(m,true);
    return Fay$$_(f)(monad.value);
  });
}

// This is used directly from Fay, but can be rebound or shadowed.
function Fay$$$_return(a){
  return new Fay$$Monad(a);
}

// Allow the programmer to access thunk forcing directly.
function Fay$$force(thunk){
  return function(type){
    return new Fay$$$(function(){
      Fay$$_(thunk,type);
      return new Fay$$Monad(Fay$$unit);
    })
  }
}

// This is used directly from Fay, but can be rebound or shadowed.
function Fay$$return$36$uncurried(a){
  return new Fay$$Monad(a);
}

// Unit: ().
var Fay$$unit = null;

/*******************************************************************************
 * Serialization.
 * Fay <-> JS. Should be bijective.
 */

// Serialize a Fay object to JS.
function Fay$$fayToJs(type,fayObj){
  var base = type[0];
  var args = type[1];
  var jsObj;
  if(base == "action") {
    // A nullary monadic action. Should become a nullary JS function.
    // Fay () -> function(){ return ... }
    return function(){
      return Fay$$fayToJs(args[0],Fay$$_(fayObj,true).value);
    };

  }
  else if(base == "function") {
    // A proper function.
    return function(){
      var fayFunc = fayObj;
      var return_type = args[args.length-1];
      var len = args.length;
      // If some arguments.
      if (len > 1) {
        // Apply to all the arguments.
        fayFunc = Fay$$_(fayFunc,true);
        // TODO: Perhaps we should throw an error when JS
        // passes more arguments than Haskell accepts.

        // Unserialize the JS values to Fay for the Fay callback.
        if (args == "automatic_function")
        {
          for (var i = 0; i < arguments.length; i++) {
            fayFunc = Fay$$_(fayFunc(Fay$$jsToFay(["automatic"],arguments[i])),true);
          }
          return Fay$$fayToJs(["automatic"], fayFunc);
        }

        for (var i = 0, len = len; i < len - 1 && fayFunc instanceof Function; i++) {
          fayFunc = Fay$$_(fayFunc(Fay$$jsToFay(args[i],arguments[i])),true);
        }
        // Finally, serialize the Fay return value back to JS.
        var return_base = return_type[0];
        var return_args = return_type[1];
        // If it's a monadic return value, get the value instead.
        if(return_base == "action") {
          return Fay$$fayToJs(return_args[0],fayFunc.value);
        }
        // Otherwise just serialize the value direct.
        else {
          return Fay$$fayToJs(return_type,fayFunc);
        }
      } else {
        throw new Error("Nullary function?");
      }
    };

  }
  else if(base == "string") {
    return Fay$$fayToJs_string(fayObj);
  }
  else if(base == "list") {
    // Serialize Fay list to JavaScript array.
    var arr = [];
    fayObj = Fay$$_(fayObj);
    while(fayObj instanceof Fay$$Cons) {
      arr.push(Fay$$fayToJs(args[0],fayObj.car));
      fayObj = Fay$$_(fayObj.cdr);
    }
    return arr;
  }
  else if(base == "tuple") {
    // Serialize Fay tuple to JavaScript array.
    var arr = [];
    fayObj = Fay$$_(fayObj);
    var i = 0;
    while(fayObj instanceof Fay$$Cons) {
      arr.push(Fay$$fayToJs(args[i++],fayObj.car));
      fayObj = Fay$$_(fayObj.cdr);
    }
    return arr;
  }
  else if(base == "defined") {
    fayObj = Fay$$_(fayObj);
    return fayObj instanceof Fay.FFI._Undefined
      ? undefined
      : Fay$$fayToJs(args[0],fayObj.slot1);
  }
  else if(base == "nullable") {
    fayObj = Fay$$_(fayObj);
    return fayObj instanceof Fay.FFI._Null
      ? null
      : Fay$$fayToJs(args[0],fayObj.slot1);
  }
  else if(base == "double" || base == "int" || base == "bool") {
    // Bools are unboxed.
    return Fay$$_(fayObj);
  }
  else if(base == "ptr")
    return fayObj;
  else if(base == "unknown")
    return Fay$$fayToJs(["automatic"], fayObj);
  else if(base == "automatic" && fayObj instanceof Function) {
    return Fay$$fayToJs(["function", "automatic_function"], fayObj);
  }
  else if(base == "automatic" || base == "user") {
    fayObj = Fay$$_(fayObj);

    if(fayObj instanceof Fay$$Cons || fayObj === null){
      // Serialize Fay list to JavaScript array.
      var arr = [];
      while(fayObj instanceof Fay$$Cons) {
        arr.push(Fay$$fayToJs(["automatic"],fayObj.car));
        fayObj = Fay$$_(fayObj.cdr);
      }
      return arr;
    } else {
      var fayToJsFun = fayObj && fayObj.instance && Fay$$fayToJsHash[fayObj.instance];
      return fayToJsFun ? fayToJsFun(type,type[2],fayObj) : fayObj;
    }
  }

  throw new Error("Unhandled Fay->JS translation type: " + base);
}

// Stores the mappings from fay types to js objects.
// This will be populated by compiled modules.
var Fay$$fayToJsHash = {};

// Specialized serializer for string.
function Fay$$fayToJs_string(fayObj){
  // Serialize Fay string to JavaScript string.
  var str = "";
  fayObj = Fay$$_(fayObj);
  while(fayObj instanceof Fay$$Cons) {
    str += Fay$$_(fayObj.car);
    fayObj = Fay$$_(fayObj.cdr);
  }
  return str;
};
function Fay$$jsToFay_string(x){
  return Fay$$list(x)
};

// Special num/bool serializers.
function Fay$$jsToFay_int(x){return x;}
function Fay$$jsToFay_double(x){return x;}
function Fay$$jsToFay_bool(x){return x;}

function Fay$$fayToJs_int(x){return Fay$$_(x);}
function Fay$$fayToJs_double(x){return Fay$$_(x);}
function Fay$$fayToJs_bool(x){return Fay$$_(x);}

// Unserialize an object from JS to Fay.
function Fay$$jsToFay(type,jsObj){
  var base = type[0];
  var args = type[1];
  var fayObj;
  if(base == "action") {
    // Unserialize a "monadic" JavaScript return value into a monadic value.
    return new Fay$$Monad(Fay$$jsToFay(args[0],jsObj));
  }
  else if(base == "function") {
    // Unserialize a function from JavaScript to a function that Fay can call.
    // So
    //
    //    var f = function(x,y,z){ … }
    //
    // becomes something like:
    //
    //    function(x){
    //      return function(y){
    //        return function(z){
    //          return new Fay$$$(function(){
    //            return Fay$$jsToFay(f(Fay$$fayTojs(x),
    //                                  Fay$$fayTojs(y),
    //                                  Fay$$fayTojs(z))
    //    }}}}};
    var returnType = args[args.length-1];
    var funArgs = args.slice(0,-1);

    if (jsObj.length > 0) {
      var makePartial = function(args){
        return function(arg){
          var i = args.length;
          var fayArg = Fay$$fayToJs(funArgs[i],arg);
          var newArgs = args.concat([fayArg]);
          if(newArgs.length == funArgs.length) {
            return new Fay$$$(function(){
              return Fay$$jsToFay(returnType,jsObj.apply(this,newArgs));
            });
          } else {
            return makePartial(newArgs);
          }
        };
      };
      return makePartial([]);
    }
    else
      return function (arg) {
        return Fay$$jsToFay(["automatic"], jsObj(Fay$$fayToJs(["automatic"], arg)));
      };
  }
  else if(base == "string") {
    // Unserialize a JS string into Fay list (String).
    // This is a special case, when String is explicit in the type signature,
    // with `Automatic' a string would not be decoded.
    return Fay$$list(jsObj);
  }
  else if(base == "list") {
    // Unserialize a JS array into a Fay list ([a]).
    var serializedList = [];
    for (var i = 0, len = jsObj.length; i < len; i++) {
      // Unserialize each JS value into a Fay value, too.
      serializedList.push(Fay$$jsToFay(args[0],jsObj[i]));
    }
    // Pop it all in a Fay list.
    return Fay$$list(serializedList);
  }
  else if(base == "tuple") {
    // Unserialize a JS array into a Fay tuple ((a,b,c,...)).
    var serializedTuple = [];
    for (var i = 0, len = jsObj.length; i < len; i++) {
      // Unserialize each JS value into a Fay value, too.
      serializedTuple.push(Fay$$jsToFay(args[i],jsObj[i]));
    }
    // Pop it all in a Fay list.
    return Fay$$list(serializedTuple);
  }
  else if(base == "defined") {
    return jsObj === undefined
      ? new Fay.FFI._Undefined()
      : new Fay.FFI._Defined(Fay$$jsToFay(args[0],jsObj));
  }
  else if(base == "nullable") {
    return jsObj === null
      ? new Fay.FFI._Null()
      : new Fay.FFI.Nullable(Fay$$jsToFay(args[0],jsObj));
  }
  else if(base == "int") {
    // Int are unboxed, so there's no forcing to do.
    // But we can do validation that the int has no decimal places.
    // E.g. Math.round(x)!=x? throw "NOT AN INTEGER, GET OUT!"
    fayObj = Math.round(jsObj);
    if(fayObj!==jsObj) throw "Argument " + jsObj + " is not an integer!";
    return fayObj;
  }
  else if (base == "double" ||
           base == "bool" ||
           base ==  "ptr") {
    return jsObj;
  }
  else if(base == "unknown")
    return Fay$$jsToFay(["automatic"], jsObj);
  else if(base == "automatic" && jsObj instanceof Function) {
    var type = [["automatic"]];
    for (var i = 0; i < jsObj.length; i++)
      type.push(["automatic"]);
    return Fay$$jsToFay(["function", type], jsObj);
  }
  else if(base == "automatic" && jsObj instanceof Array) {
    var list = null;
    for (var i = jsObj.length - 1; i >= 0; i--) {
      list = new Fay$$Cons(Fay$$jsToFay([base], jsObj[i]), list);
    }
    return list;
  }
  else if(base == "automatic" || base == "user") {
    if (jsObj && jsObj['instance']) {
      var jsToFayFun = Fay$$jsToFayHash[jsObj["instance"]];
      return jsToFayFun ? jsToFayFun(type,type[2],jsObj) : jsObj;
    }
    else
      return jsObj;
  }

  throw new Error("Unhandled JS->Fay translation type: " + base);
}

// Stores the mappings from js objects to fay types.
// This will be populated by compiled modules.
var Fay$$jsToFayHash = {};

/*******************************************************************************
 * Lists.
 */

// Cons object.
function Fay$$Cons(car,cdr){
  this.car = car;
  this.cdr = cdr;
}

// Make a list.
function Fay$$list(xs){
  var out = null;
  for(var i=xs.length-1; i>=0;i--)
    out = new Fay$$Cons(xs[i],out);
  return out;
}

// Built-in list cons.
function Fay$$cons(x){
  return function(y){
    return new Fay$$Cons(x,y);
  };
}

// List index.
// `list' is already forced by the time it's passed to this function.
// `list' cannot be null and `index' cannot be out of bounds.
function Fay$$index(index,list){
  for(var i = 0; i < index; i++) {
    list = Fay$$_(list.cdr);
  }
  return list.car;
}

// List length.
// `list' is already forced by the time it's passed to this function.
function Fay$$listLen(list,max){
  for(var i = 0; list !== null && i < max + 1; i++) {
    list = Fay$$_(list.cdr);
  }
  return i == max;
}

/*******************************************************************************
 * Numbers.
 */

// Built-in *.
function Fay$$mult(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) * Fay$$_(y);
    });
  };
}

function Fay$$mult$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) * Fay$$_(y);
  });

}

// Built-in +.
function Fay$$add(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) + Fay$$_(y);
    });
  };
}

// Built-in +.
function Fay$$add$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) + Fay$$_(y);
  });

}

// Built-in -.
function Fay$$sub(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) - Fay$$_(y);
    });
  };
}
// Built-in -.
function Fay$$sub$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) - Fay$$_(y);
  });

}

// Built-in /.
function Fay$$divi(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) / Fay$$_(y);
    });
  };
}

// Built-in /.
function Fay$$divi$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) / Fay$$_(y);
  });

}

/*******************************************************************************
 * Booleans.
 */

// Are two values equal?
function Fay$$equal(lit1, lit2) {
  // Simple case
  lit1 = Fay$$_(lit1);
  lit2 = Fay$$_(lit2);
  if (lit1 === lit2) {
    return true;
  }
  // General case
  if (lit1 instanceof Array) {
    if (lit1.length != lit2.length) return false;
    for (var len = lit1.length, i = 0; i < len; i++) {
      if (!Fay$$equal(lit1[i], lit2[i])) return false;
    }
    return true;
  } else if (lit1 instanceof Fay$$Cons && lit2 instanceof Fay$$Cons) {
    do {
      if (!Fay$$equal(lit1.car,lit2.car))
        return false;
      lit1 = Fay$$_(lit1.cdr), lit2 = Fay$$_(lit2.cdr);
      if (lit1 === null || lit2 === null)
        return lit1 === lit2;
    } while (true);
  } else if (typeof lit1 == 'object' && typeof lit2 == 'object' && lit1 && lit2 &&
             lit1.instance === lit2.instance) {
    for(var x in lit1) {
      if(!Fay$$equal(lit1[x],lit2[x]))
        return false;
    }
    return true;
  } else {
    return false;
  }
}

// Built-in ==.
function Fay$$eq(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$equal(x,y);
    });
  };
}

function Fay$$eq$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$equal(x,y);
  });

}

// Built-in /=.
function Fay$$neq(x){
  return function(y){
    return new Fay$$$(function(){
      return !(Fay$$equal(x,y));
    });
  };
}

// Built-in /=.
function Fay$$neq$36$uncurried(x,y){

  return new Fay$$$(function(){
    return !(Fay$$equal(x,y));
  });

}

// Built-in >.
function Fay$$gt(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) > Fay$$_(y);
    });
  };
}

// Built-in >.
function Fay$$gt$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) > Fay$$_(y);
  });

}

// Built-in <.
function Fay$$lt(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) < Fay$$_(y);
    });
  };
}


// Built-in <.
function Fay$$lt$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) < Fay$$_(y);
  });

}


// Built-in >=.
function Fay$$gte(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) >= Fay$$_(y);
    });
  };
}

// Built-in >=.
function Fay$$gte$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) >= Fay$$_(y);
  });

}

// Built-in <=.
function Fay$$lte(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) <= Fay$$_(y);
    });
  };
}

// Built-in <=.
function Fay$$lte$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) <= Fay$$_(y);
  });

}

// Built-in &&.
function Fay$$and(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) && Fay$$_(y);
    });
  };
}

// Built-in &&.
function Fay$$and$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) && Fay$$_(y);
  });
  ;
}

// Built-in ||.
function Fay$$or(x){
  return function(y){
    return new Fay$$$(function(){
      return Fay$$_(x) || Fay$$_(y);
    });
  };
}

// Built-in ||.
function Fay$$or$36$uncurried(x,y){

  return new Fay$$$(function(){
    return Fay$$_(x) || Fay$$_(y);
  });

}

/*******************************************************************************
 * Mutable references.
 */

// Make a new mutable reference.
function Fay$$Ref(x){
  this.value = x;
}

// Write to the ref.
function Fay$$writeRef(ref,x){
  ref.value = x;
}

// Get the value from the ref.
function Fay$$readRef(ref){
  return ref.value;
}

/*******************************************************************************
 * Dates.
 */
function Fay$$date(str){
  return Date.parse(str);
}

/*******************************************************************************
 * Data.Var
 */

function Fay$$Ref2(val){
  this.val = val;
}

function Fay$$Sig(){
  this.handlers = [];
}

function Fay$$Var(val){
  this.val = val;
  this.handlers = [];
}

// Helper used by Fay$$setValue and for merging
function Fay$$broadcastInternal(self, val, force){
  var handlers = self.handlers;
  var exceptions = [];
  for(var len = handlers.length, i = 0; i < len; i++) {
    try {
      force(handlers[i][1](val), true);
    } catch (e) {
      exceptions.push(e);
    }
  }
  // Rethrow the encountered exceptions.
  if (exceptions.length > 0) {
    console.error("Encountered " + exceptions.length + " exception(s) while broadcasing a change to ", self);
    for(var len = exceptions.length, i = 0; i < len; i++) {
      (function(exception) {
        setTimeout(function() { throw exception; }, 0);
      })(exceptions[i]);
    }
  }
}

function Fay$$setValue(self, val, force){
  if (self instanceof Fay$$Ref2) {
    self.val = val;
  } else if (self instanceof Fay$$Var) {
    self.val = val;
    Fay$$broadcastInternal(self, val, force);
  } else if (self instanceof Fay$$Sig) {
    Fay$$broadcastInternal(self, val, force);
  } else {
    throw "Fay$$setValue given something that's not a Ref2, Var, or Sig"
  }
}

function Fay$$subscribe(self, f){
  var key = {};
  self.handlers.push([key,f]);
  var searchStart = self.handlers.length - 1;
  return function(_){
    for(var i = Math.min(searchStart, self.handlers.length - 1); i >= 0; i--) {
      if(self.handlers[i][0] == key) {
        self.handlers = self.handlers.slice(0,i).concat(self.handlers.slice(i+1));
        return;
      }
    }
    return _; // This variable has to be used, otherwise Closure
              // strips it out and Fay serialization breaks.
  };
}

/*******************************************************************************
 * Application code.
 */

var Data = {};Data.Data = {};var Fay = {};Fay.FFI = {};Fay.FFI._Nullable = function Nullable(slot1){this.slot1 = slot1;};Fay.FFI._Nullable.prototype.instance = "Nullable";Fay.FFI.Nullable = function(slot1){return new Fay$$$(function(){return new Fay.FFI._Nullable(slot1);});};Fay.FFI._Null = function Null(){};Fay.FFI._Null.prototype.instance = "Null";Fay.FFI.Null = new Fay$$$(function(){return new Fay.FFI._Null();});Fay.FFI._Defined = function Defined(slot1){this.slot1 = slot1;};Fay.FFI._Defined.prototype.instance = "Defined";Fay.FFI.Defined = function(slot1){return new Fay$$$(function(){return new Fay.FFI._Defined(slot1);});};Fay.FFI._Undefined = function Undefined(){};Fay.FFI._Undefined.prototype.instance = "Undefined";Fay.FFI.Undefined = new Fay$$$(function(){return new Fay.FFI._Undefined();});Fay$$objConcat(Fay$$fayToJsHash,{"Nullable": function(type,argTypes,_obj){var obj_ = {"instance": "Nullable"};var obj_slot1 = Fay$$fayToJs(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],_obj.slot1);if (undefined !== obj_slot1) {obj_['slot1'] = obj_slot1;}return obj_;},"Null": function(type,argTypes,_obj){var obj_ = {"instance": "Null"};return obj_;},"Defined": function(type,argTypes,_obj){var obj_ = {"instance": "Defined"};var obj_slot1 = Fay$$fayToJs(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],_obj.slot1);if (undefined !== obj_slot1) {obj_['slot1'] = obj_slot1;}return obj_;},"Undefined": function(type,argTypes,_obj){var obj_ = {"instance": "Undefined"};return obj_;}});Fay$$objConcat(Fay$$jsToFayHash,{"Nullable": function(type,argTypes,obj){return new Fay.FFI._Nullable(Fay$$jsToFay(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],obj["slot1"]));},"Null": function(type,argTypes,obj){return new Fay.FFI._Null();},"Defined": function(type,argTypes,obj){return new Fay.FFI._Defined(Fay$$jsToFay(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],obj["slot1"]));},"Undefined": function(type,argTypes,obj){return new Fay.FFI._Undefined();}});var Prelude = {};Prelude._Just = function Just(slot1){this.slot1 = slot1;};Prelude._Just.prototype.instance = "Just";Prelude.Just = function(slot1){return new Fay$$$(function(){return new Prelude._Just(slot1);});};Prelude._Nothing = function Nothing(){};Prelude._Nothing.prototype.instance = "Nothing";Prelude.Nothing = new Fay$$$(function(){return new Prelude._Nothing();});Prelude._Left = function Left(slot1){this.slot1 = slot1;};Prelude._Left.prototype.instance = "Left";Prelude.Left = function(slot1){return new Fay$$$(function(){return new Prelude._Left(slot1);});};Prelude._Right = function Right(slot1){this.slot1 = slot1;};Prelude._Right.prototype.instance = "Right";Prelude.Right = function(slot1){return new Fay$$$(function(){return new Prelude._Right(slot1);});};Prelude.maybe = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) instanceof Prelude._Nothing) {var m = $p1;return m;}if (Fay$$_($p3) instanceof Prelude._Just) {var x = Fay$$_($p3).slot1;var f = $p2;return Fay$$_(f)(x);}throw ["unhandled case in maybe",[$p1,$p2,$p3]];});};};};Prelude.$62$$62$$61$ = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$_(Fay$$bind($p1)($p2));});};};Prelude.$62$$62$ = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$_(Fay$$then($p1)($p2));});};};Prelude.$_return = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$$_return(Fay$$fayToJs(["unknown"],$p1))));});};Prelude.fail = new Fay$$$(function(){return Prelude.error;});Prelude.when = function($p1){return function($p2){return new Fay$$$(function(){var m = $p2;var p = $p1;return Fay$$_(p) ? m : Fay$$_(Fay$$$_return)(Fay$$unit);});};};Prelude.unless = function($p1){return function($p2){return new Fay$$$(function(){var m = $p2;var p = $p1;return Fay$$_(p) ? Fay$$_(Fay$$$_return)(Fay$$unit) : m;});};};Prelude.forM = function($p1){return function($p2){return new Fay$$$(function(){var fn = $p2;var lst = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.sequence))(Fay$$_(Fay$$_(Prelude.map)(fn))(lst));});};};Prelude.forM_ = function($p1){return function($p2){return new Fay$$$(function(){var m = $p2;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(m)(x)))(Fay$$_(Fay$$_(Prelude.forM_)(xs))(m));}if (Fay$$_($p1) === null) {return Fay$$_(Fay$$$_return)(Fay$$unit);}throw ["unhandled case in forM_",[$p1,$p2]];});};};Prelude.mapM = function($p1){return function($p2){return new Fay$$$(function(){var lst = $p2;var fn = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.sequence))(Fay$$_(Fay$$_(Prelude.map)(fn))(lst));});};};Prelude.mapM_ = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var m = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(m)(x)))(Fay$$_(Fay$$_(Prelude.mapM_)(m))(xs));}if (Fay$$_($p2) === null) {return Fay$$_(Fay$$$_return)(Fay$$unit);}throw ["unhandled case in mapM_",[$p1,$p2]];});};};Prelude.$61$$60$$60$ = function($p1){return function($p2){return new Fay$$$(function(){var x = $p2;var f = $p1;return Fay$$_(Fay$$_(Fay$$bind)(x))(f);});};};Prelude.$_void = function($p1){return new Fay$$$(function(){var f = $p1;return Fay$$_(Fay$$_(Fay$$then)(f))(Fay$$_(Fay$$$_return)(Fay$$unit));});};Prelude.$62$$61$$62$ = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var x = $p3;var g = $p2;var f = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(f)(x)))(g);});};};};Prelude.$60$$61$$60$ = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var x = $p3;var f = $p2;var g = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(f)(x)))(g);});};};};Prelude.sequence = function($p1){return new Fay$$$(function(){var ms = $p1;return (function(){var k = function($p1){return function($p2){return new Fay$$$(function(){var m$39$ = $p2;var m = $p1;return Fay$$_(Fay$$_(Fay$$bind)(m))(function($p1){var x = $p1;return Fay$$_(Fay$$_(Fay$$bind)(m$39$))(function($p1){var xs = $p1;return Fay$$_(Fay$$$_return)(Fay$$_(Fay$$_(Fay$$cons)(x))(xs));});});});};};return Fay$$_(Fay$$_(Fay$$_(Prelude.foldr)(k))(Fay$$_(Fay$$$_return)(null)))(ms);})();});};Prelude.sequence_ = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Fay$$$_return)(Fay$$unit);}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var m = $tmp1.car;var ms = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$then)(m))(Fay$$_(Prelude.sequence_)(ms));}throw ["unhandled case in sequence_",[$p1]];});};Prelude._GT = function GT(){};Prelude._GT.prototype.instance = "GT";Prelude.GT = new Fay$$$(function(){return new Prelude._GT();});Prelude._LT = function LT(){};Prelude._LT.prototype.instance = "LT";Prelude.LT = new Fay$$$(function(){return new Prelude._LT();});Prelude._EQ = function EQ(){};Prelude._EQ.prototype.instance = "EQ";Prelude.EQ = new Fay$$$(function(){return new Prelude._EQ();});Prelude.compare = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(x))(y)) ? Prelude.GT : Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(x))(y)) ? Prelude.LT : Prelude.EQ;});};};Prelude.succ = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$add)(x))(1);});};Prelude.pred = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$sub)(x))(1);});};Prelude.enumFrom = function($p1){return new Fay$$$(function(){var i = $p1;return Fay$$_(Fay$$_(Fay$$cons)(i))(Fay$$_(Prelude.enumFrom)(Fay$$_(Fay$$_(Fay$$add)(i))(1)));});};Prelude.enumFromTo = function($p1){return function($p2){return new Fay$$$(function(){var n = $p2;var i = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(i))(n)) ? null : Fay$$_(Fay$$_(Fay$$cons)(i))(Fay$$_(Fay$$_(Prelude.enumFromTo)(Fay$$_(Fay$$_(Fay$$add)(i))(1)))(n));});};};Prelude.enumFromBy = function($p1){return function($p2){return new Fay$$$(function(){var by = $p2;var fr = $p1;return Fay$$_(Fay$$_(Fay$$cons)(fr))(Fay$$_(Fay$$_(Prelude.enumFromBy)(Fay$$_(Fay$$_(Fay$$add)(fr))(by)))(by));});};};Prelude.enumFromThen = function($p1){return function($p2){return new Fay$$$(function(){var th = $p2;var fr = $p1;return Fay$$_(Fay$$_(Prelude.enumFromBy)(fr))(Fay$$_(Fay$$_(Fay$$sub)(th))(fr));});};};Prelude.enumFromByTo = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var to = $p3;var by = $p2;var fr = $p1;return (function(){var neg = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(x))(to)) ? null : Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(neg)(Fay$$_(Fay$$_(Fay$$add)(x))(by)));});};var pos = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(x))(to)) ? null : Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(pos)(Fay$$_(Fay$$_(Fay$$add)(x))(by)));});};return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(by))(0)) ? Fay$$_(neg)(fr) : Fay$$_(pos)(fr);})();});};};};Prelude.enumFromThenTo = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var to = $p3;var th = $p2;var fr = $p1;return Fay$$_(Fay$$_(Fay$$_(Prelude.enumFromByTo)(fr))(Fay$$_(Fay$$_(Fay$$sub)(th))(fr)))(to);});};};};Prelude.fromIntegral = function($p1){return new Fay$$$(function(){return $p1;});};Prelude.fromInteger = function($p1){return new Fay$$$(function(){return $p1;});};Prelude.not = function($p1){return new Fay$$$(function(){var p = $p1;return Fay$$_(p) ? false : true;});};Prelude.otherwise = true;Prelude.show = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_string(JSON.stringify(Fay$$fayToJs(["automatic"],$p1)));});};Prelude.error = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],(function() { throw Fay$$fayToJs_string($p1) })());});};Prelude.$_undefined = new Fay$$$(function(){return Fay$$_(Prelude.error)(Fay$$list("Prelude.undefined"));});Prelude.either = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) instanceof Prelude._Left) {var a = Fay$$_($p3).slot1;var f = $p1;return Fay$$_(f)(a);}if (Fay$$_($p3) instanceof Prelude._Right) {var b = Fay$$_($p3).slot1;var g = $p2;return Fay$$_(g)(b);}throw ["unhandled case in either",[$p1,$p2,$p3]];});};};};Prelude.until = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var x = $p3;var f = $p2;var p = $p1;return Fay$$_(Fay$$_(p)(x)) ? x : Fay$$_(Fay$$_(Fay$$_(Prelude.until)(p))(f))(Fay$$_(f)(x));});};};};Prelude.$36$$33$ = function($p1){return function($p2){return new Fay$$$(function(){var x = $p2;var f = $p1;return Fay$$_(Fay$$_(Fay$$seq)(x))(Fay$$_(f)(x));});};};Prelude.$_const = function($p1){return function($p2){return new Fay$$$(function(){var a = $p1;return a;});};};Prelude.id = function($p1){return new Fay$$$(function(){var x = $p1;return x;});};Prelude.$46$ = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var x = $p3;var g = $p2;var f = $p1;return Fay$$_(f)(Fay$$_(g)(x));});};};};Prelude.$36$ = function($p1){return function($p2){return new Fay$$$(function(){var x = $p2;var f = $p1;return Fay$$_(f)(x);});};};Prelude.flip = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var y = $p3;var x = $p2;var f = $p1;return Fay$$_(Fay$$_(f)(y))(x);});};};};Prelude.curry = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var y = $p3;var x = $p2;var f = $p1;return Fay$$_(f)(Fay$$list([x,y]));});};};};Prelude.uncurry = function($p1){return function($p2){return new Fay$$$(function(){var p = $p2;var f = $p1;return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var x = Fay$$index(0,Fay$$_($tmp1));var y = Fay$$index(1,Fay$$_($tmp1));return Fay$$_(Fay$$_(f)(x))(y);}return (function(){ throw (["unhandled case",$tmp1]); })();})(p);});};};Prelude.snd = function($p1){return new Fay$$$(function(){if (Fay$$listLen(Fay$$_($p1),2)) {var x = Fay$$index(1,Fay$$_($p1));return x;}throw ["unhandled case in snd",[$p1]];});};Prelude.fst = function($p1){return new Fay$$$(function(){if (Fay$$listLen(Fay$$_($p1),2)) {var x = Fay$$index(0,Fay$$_($p1));return x;}throw ["unhandled case in fst",[$p1]];});};Prelude.div = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;if (Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(x))(0)))(Fay$$_(Fay$$_(Fay$$lt)(y))(0)))) {return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.quot)(Fay$$_(Fay$$_(Fay$$sub)(x))(1)))(y)))(1);} else {if (Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(x))(0)))(Fay$$_(Fay$$_(Fay$$gt)(y))(0)))) {return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.quot)(Fay$$_(Fay$$_(Fay$$add)(x))(1)))(y)))(1);}}var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Prelude.quot)(x))(y);});};};Prelude.mod = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;if (Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(x))(0)))(Fay$$_(Fay$$_(Fay$$lt)(y))(0)))) {return Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.rem)(Fay$$_(Fay$$_(Fay$$sub)(x))(1)))(y)))(y)))(1);} else {if (Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(x))(0)))(Fay$$_(Fay$$_(Fay$$gt)(y))(0)))) {return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.rem)(Fay$$_(Fay$$_(Fay$$add)(x))(1)))(y)))(y)))(1);}}var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Prelude.rem)(x))(y);});};};Prelude.divMod = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;if (Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(x))(0)))(Fay$$_(Fay$$_(Fay$$lt)(y))(0)))) {return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var q = Fay$$index(0,Fay$$_($tmp1));var r = Fay$$index(1,Fay$$_($tmp1));return Fay$$list([Fay$$_(Fay$$_(Fay$$sub)(q))(1),Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$add)(r))(y)))(1)]);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.quotRem)(Fay$$_(Fay$$_(Fay$$sub)(x))(1)))(y));} else {if (Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(x))(0)))(Fay$$_(Fay$$_(Fay$$gt)(y))(1)))) {return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var q = Fay$$index(0,Fay$$_($tmp1));var r = Fay$$index(1,Fay$$_($tmp1));return Fay$$list([Fay$$_(Fay$$_(Fay$$sub)(q))(1),Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$add)(r))(y)))(1)]);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.quotRem)(Fay$$_(Fay$$_(Fay$$add)(x))(1)))(y));}}var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Prelude.quotRem)(x))(y);});};};Prelude.min = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.min(Fay$$_(Fay$$fayToJs(["unknown"],$p1)),Fay$$_(Fay$$fayToJs(["unknown"],$p2))));});};};Prelude.max = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.max(Fay$$_(Fay$$fayToJs(["unknown"],$p1)),Fay$$_(Fay$$fayToJs(["unknown"],$p2))));});};};Prelude.recip = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$divi)(1))(x);});};Prelude.negate = function($p1){return new Fay$$$(function(){var x = $p1;return (-(Fay$$_(x)));});};Prelude.abs = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(x))(0)) ? Fay$$_(Prelude.negate)(x) : x;});};Prelude.signum = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(x))(0)) ? 1 : Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(x))(0)) ? 0 : (-(1));});};Prelude.pi = new Fay$$$(function(){return Fay$$jsToFay_double(Math.PI);});Prelude.exp = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.exp(Fay$$fayToJs_double($p1)));});};Prelude.sqrt = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.sqrt(Fay$$fayToJs_double($p1)));});};Prelude.log = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.log(Fay$$fayToJs_double($p1)));});};Prelude.$42$$42$ = new Fay$$$(function(){return Prelude.unsafePow;});Prelude.$94$$94$ = new Fay$$$(function(){return Prelude.unsafePow;});Prelude.unsafePow = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.pow(Fay$$_(Fay$$fayToJs(["unknown"],$p1)),Fay$$_(Fay$$fayToJs(["unknown"],$p2))));});};};Prelude.$94$ = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var a = $p1;if (Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(b))(0))) {return Fay$$_(Prelude.error)(Fay$$list("(^): negative exponent"));} else {if (Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(b))(0))) {return 1;} else {if (Fay$$_(Fay$$_(Prelude.even)(b))) {return (function(){return new Fay$$$(function(){var x = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$94$)(a))(Fay$$_(Fay$$_(Prelude.quot)(b))(2));});return Fay$$_(Fay$$_(Fay$$mult)(x))(x);});})();}}}var b = $p2;var a = $p1;return Fay$$_(Fay$$_(Fay$$mult)(a))(Fay$$_(Fay$$_(Prelude.$94$)(a))(Fay$$_(Fay$$_(Fay$$sub)(b))(1)));});};};Prelude.logBase = function($p1){return function($p2){return new Fay$$$(function(){var x = $p2;var b = $p1;return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.log)(x)))(Fay$$_(Prelude.log)(b));});};};Prelude.sin = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.sin(Fay$$fayToJs_double($p1)));});};Prelude.tan = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.tan(Fay$$fayToJs_double($p1)));});};Prelude.cos = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.cos(Fay$$fayToJs_double($p1)));});};Prelude.asin = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.asin(Fay$$fayToJs_double($p1)));});};Prelude.atan = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.atan(Fay$$fayToJs_double($p1)));});};Prelude.acos = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.acos(Fay$$fayToJs_double($p1)));});};Prelude.sinh = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Prelude.exp)(x)))(Fay$$_(Prelude.exp)((-(Fay$$_(x)))))))(2);});};Prelude.tanh = function($p1){return new Fay$$$(function(){var x = $p1;return (function(){return new Fay$$$(function(){var a = new Fay$$$(function(){return Fay$$_(Prelude.exp)(x);});var b = new Fay$$$(function(){return Fay$$_(Prelude.exp)((-(Fay$$_(x))));});return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(a))(b)))(Fay$$_(Fay$$_(Fay$$add)(a))(b));});})();});};Prelude.cosh = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Prelude.exp)(x)))(Fay$$_(Prelude.exp)((-(Fay$$_(x)))))))(2);});};Prelude.asinh = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$add)(x))(Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.$42$$42$)(x))(2)))(1))));});};Prelude.atanh = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$add)(1))(x)))(Fay$$_(Fay$$_(Fay$$sub)(1))(x)))))(2);});};Prelude.acosh = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$add)(x))(Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.$42$$42$)(x))(2)))(1))));});};Prelude.properFraction = function($p1){return new Fay$$$(function(){var x = $p1;return (function(){return new Fay$$$(function(){var a = new Fay$$$(function(){return Fay$$_(Prelude.truncate)(x);});return Fay$$list([a,Fay$$_(Fay$$_(Fay$$sub)(x))(Fay$$_(Prelude.fromIntegral)(a))]);});})();});};Prelude.truncate = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(x))(0)) ? Fay$$_(Prelude.ceiling)(x) : Fay$$_(Prelude.floor)(x);});};Prelude.round = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.round(Fay$$fayToJs_double($p1)));});};Prelude.ceiling = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.ceil(Fay$$fayToJs_double($p1)));});};Prelude.floor = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.floor(Fay$$fayToJs_double($p1)));});};Prelude.subtract = new Fay$$$(function(){return Fay$$_(Prelude.flip)(Fay$$sub);});Prelude.even = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(Prelude.rem)(x))(2)))(0);});};Prelude.odd = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Prelude.not)(Fay$$_(Prelude.even)(x));});};Prelude.gcd = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var a = $p1;return (function(){var go = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === 0) {var x = $p1;return x;}var y = $p2;var x = $p1;return Fay$$_(Fay$$_(go)(y))(Fay$$_(Fay$$_(Prelude.rem)(x))(y));});};};return Fay$$_(Fay$$_(go)(Fay$$_(Prelude.abs)(a)))(Fay$$_(Prelude.abs)(b));})();});};};Prelude.quot = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(y))(0)) ? Fay$$_(Prelude.error)(Fay$$list("Division by zero")) : Fay$$_(Fay$$_(Prelude.quot$39$)(x))(y);});};};Prelude.quot$39$ = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay_int(~~(Fay$$fayToJs_int($p1)/Fay$$fayToJs_int($p2)));});};};Prelude.quotRem = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$list([Fay$$_(Fay$$_(Prelude.quot)(x))(y),Fay$$_(Fay$$_(Prelude.rem)(x))(y)]);});};};Prelude.rem = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(y))(0)) ? Fay$$_(Prelude.error)(Fay$$list("Division by zero")) : Fay$$_(Fay$$_(Prelude.rem$39$)(x))(y);});};};Prelude.rem$39$ = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs_int($p1) % Fay$$fayToJs_int($p2));});};};Prelude.lcm = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === 0) {return 0;}if (Fay$$_($p1) === 0) {return 0;}var b = $p2;var a = $p1;return Fay$$_(Prelude.abs)(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Prelude.quot)(a))(Fay$$_(Fay$$_(Prelude.gcd)(a))(b))))(b));});};};Prelude.find = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(p)(x)) ? Fay$$_(Prelude.Just)(x) : Fay$$_(Fay$$_(Prelude.find)(p))(xs);}if (Fay$$_($p2) === null) {return Prelude.Nothing;}throw ["unhandled case in find",[$p1,$p2]];});};};Prelude.filter = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(p)(x)) ? Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.filter)(p))(xs)) : Fay$$_(Fay$$_(Prelude.filter)(p))(xs);}if (Fay$$_($p2) === null) {return null;}throw ["unhandled case in filter",[$p1,$p2]];});};};Prelude.$_null = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return true;}return false;});};Prelude.map = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(f)(x)))(Fay$$_(Fay$$_(Prelude.map)(f))(xs));}throw ["unhandled case in map",[$p1,$p2]];});};};Prelude.nub = function($p1){return new Fay$$$(function(){var ls = $p1;return Fay$$_(Fay$$_(Prelude.nub$39$)(ls))(null);});};Prelude.nub$39$ = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return null;}var ls = $p2;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.elem)(x))(ls)) ? Fay$$_(Fay$$_(Prelude.nub$39$)(xs))(ls) : Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.nub$39$)(xs))(Fay$$_(Fay$$_(Fay$$cons)(x))(ls)));}throw ["unhandled case in nub'",[$p1,$p2]];});};};Prelude.elem = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var y = $tmp1.car;var ys = $tmp1.cdr;var x = $p1;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(Fay$$_(Fay$$eq)(x))(y)))(Fay$$_(Fay$$_(Prelude.elem)(x))(ys));}if (Fay$$_($p2) === null) {return false;}throw ["unhandled case in elem",[$p1,$p2]];});};};Prelude.notElem = function($p1){return function($p2){return new Fay$$$(function(){var ys = $p2;var x = $p1;return Fay$$_(Prelude.not)(Fay$$_(Fay$$_(Prelude.elem)(x))(ys));});};};Prelude.sort = new Fay$$$(function(){return Fay$$_(Prelude.sortBy)(Prelude.compare);});Prelude.sortBy = function($p1){return new Fay$$$(function(){var cmp = $p1;return Fay$$_(Fay$$_(Prelude.foldr)(Fay$$_(Prelude.insertBy)(cmp)))(null);});};Prelude.insertBy = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) === null) {var x = $p2;return Fay$$list([x]);}var ys = $p3;var x = $p2;var cmp = $p1;return (function($tmp1){if (Fay$$_($tmp1) === null) {return Fay$$list([x]);}var $tmp2 = Fay$$_($tmp1);if ($tmp2 instanceof Fay$$Cons) {var y = $tmp2.car;var ys$39$ = $tmp2.cdr;return (function($tmp2){if (Fay$$_($tmp2) instanceof Prelude._GT) {return Fay$$_(Fay$$_(Fay$$cons)(y))(Fay$$_(Fay$$_(Fay$$_(Prelude.insertBy)(cmp))(x))(ys$39$));}return Fay$$_(Fay$$_(Fay$$cons)(x))(ys);})(Fay$$_(Fay$$_(cmp)(x))(y));}return (function(){ throw (["unhandled case",$tmp1]); })();})(ys);});};};};Prelude.conc = function($p1){return function($p2){return new Fay$$$(function(){var ys = $p2;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.conc)(xs))(ys));}var ys = $p2;if (Fay$$_($p1) === null) {return ys;}throw ["unhandled case in conc",[$p1,$p2]];});};};Prelude.concat = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Prelude.conc))(null);});Prelude.concatMap = function($p1){return new Fay$$$(function(){var f = $p1;return Fay$$_(Fay$$_(Prelude.foldr)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.$43$$43$))(f)))(null);});};Prelude.foldr = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) === null) {var z = $p2;return z;}var $tmp1 = Fay$$_($p3);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var z = $p2;var f = $p1;return Fay$$_(Fay$$_(f)(x))(Fay$$_(Fay$$_(Fay$$_(Prelude.foldr)(f))(z))(xs));}throw ["unhandled case in foldr",[$p1,$p2,$p3]];});};};};Prelude.foldr1 = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$listLen(Fay$$_($p2),1)) {var x = Fay$$index(0,Fay$$_($p2));return x;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(f)(x))(Fay$$_(Fay$$_(Prelude.foldr1)(f))(xs));}if (Fay$$_($p2) === null) {return Fay$$_(Prelude.error)(Fay$$list("foldr1: empty list"));}throw ["unhandled case in foldr1",[$p1,$p2]];});};};Prelude.foldl = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) === null) {var z = $p2;return z;}var $tmp1 = Fay$$_($p3);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var z = $p2;var f = $p1;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(f))(Fay$$_(Fay$$_(f)(z))(x)))(xs);}throw ["unhandled case in foldl",[$p1,$p2,$p3]];});};};};Prelude.foldl1 = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(f))(x))(xs);}if (Fay$$_($p2) === null) {return Fay$$_(Prelude.error)(Fay$$list("foldl1: empty list"));}throw ["unhandled case in foldl1",[$p1,$p2]];});};};Prelude.$43$$43$ = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Prelude.conc)(x))(y);});};};Prelude.$33$$33$ = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var a = $p1;return (function(){var go = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("(!!): index too large"));}if (Fay$$_($p2) === 0) {var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var h = $tmp1.car;return h;}}var n = $p2;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var t = $tmp1.cdr;return Fay$$_(Fay$$_(go)(t))(Fay$$_(Fay$$_(Fay$$sub)(n))(1));}throw ["unhandled case in go",[$p1,$p2]];});};};return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(b))(0)) ? Fay$$_(Prelude.error)(Fay$$list("(!!): negative index")) : Fay$$_(Fay$$_(go)(a))(b);})();});};};Prelude.head = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("head: empty list"));}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var h = $tmp1.car;return h;}throw ["unhandled case in head",[$p1]];});};Prelude.tail = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("tail: empty list"));}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var t = $tmp1.cdr;return t;}throw ["unhandled case in tail",[$p1]];});};Prelude.init = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("init: empty list"));}if (Fay$$listLen(Fay$$_($p1),1)) {return null;}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var h = $tmp1.car;var t = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$cons)(h))(Fay$$_(Prelude.init)(t));}throw ["unhandled case in init",[$p1]];});};Prelude.last = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("last: empty list"));}if (Fay$$listLen(Fay$$_($p1),1)) {var a = Fay$$index(0,Fay$$_($p1));return a;}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var t = $tmp1.cdr;return Fay$$_(Prelude.last)(t);}throw ["unhandled case in last",[$p1]];});};Prelude.iterate = function($p1){return function($p2){return new Fay$$$(function(){var x = $p2;var f = $p1;return Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.iterate)(f))(Fay$$_(f)(x)));});};};Prelude.repeat = function($p1){return new Fay$$$(function(){var x = $p1;return Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Prelude.repeat)(x));});};Prelude.replicate = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p1) === 0) {return null;}var x = $p2;var n = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(n))(0)) ? null : Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.replicate)(Fay$$_(Fay$$_(Fay$$sub)(n))(1)))(x));});};};Prelude.cycle = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("cycle: empty list"));}var xs = $p1;return (function(){var xs$39$ = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$43$$43$)(xs))(xs$39$);});return xs$39$;})();});};Prelude.take = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p1) === 0) {return null;}if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var n = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(n))(0)) ? null : Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.take)(Fay$$_(Fay$$_(Fay$$sub)(n))(1)))(xs));}throw ["unhandled case in take",[$p1,$p2]];});};};Prelude.drop = function($p1){return function($p2){return new Fay$$$(function(){var xs = $p2;if (Fay$$_($p1) === 0) {return xs;}if (Fay$$_($p2) === null) {return null;}var xss = $p2;var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var xs = $tmp1.cdr;var n = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(n))(0)) ? xss : Fay$$_(Fay$$_(Prelude.drop)(Fay$$_(Fay$$_(Fay$$sub)(n))(1)))(xs);}throw ["unhandled case in drop",[$p1,$p2]];});};};Prelude.splitAt = function($p1){return function($p2){return new Fay$$$(function(){var xs = $p2;if (Fay$$_($p1) === 0) {return Fay$$list([null,xs]);}if (Fay$$_($p2) === null) {return Fay$$list([null,null]);}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var n = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(n))(0)) ? Fay$$list([null,Fay$$_(Fay$$_(Fay$$cons)(x))(xs)]) : (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var a = Fay$$index(0,Fay$$_($tmp1));var b = Fay$$index(1,Fay$$_($tmp1));return Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(x))(a),b]);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.splitAt)(Fay$$_(Fay$$_(Fay$$sub)(n))(1)))(xs));}throw ["unhandled case in splitAt",[$p1,$p2]];});};};Prelude.takeWhile = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(p)(x)) ? Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.takeWhile)(p))(xs)) : null;}throw ["unhandled case in takeWhile",[$p1,$p2]];});};};Prelude.dropWhile = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(p)(x)) ? Fay$$_(Fay$$_(Prelude.dropWhile)(p))(xs) : Fay$$_(Fay$$_(Fay$$cons)(x))(xs);}throw ["unhandled case in dropWhile",[$p1,$p2]];});};};Prelude.span = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return Fay$$list([null,null]);}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(p)(x)) ? (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var a = Fay$$index(0,Fay$$_($tmp1));var b = Fay$$index(1,Fay$$_($tmp1));return Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(x))(a),b]);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.span)(p))(xs)) : Fay$$list([null,Fay$$_(Fay$$_(Fay$$cons)(x))(xs)]);}throw ["unhandled case in span",[$p1,$p2]];});};};Prelude.$_break = function($p1){return new Fay$$$(function(){var p = $p1;return Fay$$_(Prelude.span)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.not))(p));});};Prelude.zipWith = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var $tmp1 = Fay$$_($p3);if ($tmp1 instanceof Fay$$Cons) {var b = $tmp1.car;var bs = $tmp1.cdr;var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var a = $tmp1.car;var as = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(f)(a))(b)))(Fay$$_(Fay$$_(Fay$$_(Prelude.zipWith)(f))(as))(bs));}}return null;});};};};Prelude.zipWith3 = function($p1){return function($p2){return function($p3){return function($p4){return new Fay$$$(function(){var $tmp1 = Fay$$_($p4);if ($tmp1 instanceof Fay$$Cons) {var c = $tmp1.car;var cs = $tmp1.cdr;var $tmp1 = Fay$$_($p3);if ($tmp1 instanceof Fay$$Cons) {var b = $tmp1.car;var bs = $tmp1.cdr;var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var a = $tmp1.car;var as = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(Fay$$_(f)(a))(b))(c)))(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Prelude.zipWith3)(f))(as))(bs))(cs));}}}return null;});};};};};Prelude.zip = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var b = $tmp1.car;var bs = $tmp1.cdr;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var a = $tmp1.car;var as = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$list([a,b])))(Fay$$_(Fay$$_(Prelude.zip)(as))(bs));}}return null;});};};Prelude.zip3 = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var $tmp1 = Fay$$_($p3);if ($tmp1 instanceof Fay$$Cons) {var c = $tmp1.car;var cs = $tmp1.cdr;var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var b = $tmp1.car;var bs = $tmp1.cdr;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var a = $tmp1.car;var as = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$list([a,b,c])))(Fay$$_(Fay$$_(Fay$$_(Prelude.zip3)(as))(bs))(cs));}}}return null;});};};};Prelude.unzip = function($p1){return new Fay$$$(function(){var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {if (Fay$$listLen(Fay$$_($tmp1.car),2)) {var x = Fay$$index(0,Fay$$_($tmp1.car));var y = Fay$$index(1,Fay$$_($tmp1.car));var ps = $tmp1.cdr;return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var xs = Fay$$index(0,Fay$$_($tmp1));var ys = Fay$$index(1,Fay$$_($tmp1));return Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(x))(xs),Fay$$_(Fay$$_(Fay$$cons)(y))(ys)]);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Prelude.unzip)(ps));}}if (Fay$$_($p1) === null) {return Fay$$list([null,null]);}throw ["unhandled case in unzip",[$p1]];});};Prelude.unzip3 = function($p1){return new Fay$$$(function(){var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {if (Fay$$listLen(Fay$$_($tmp1.car),3)) {var x = Fay$$index(0,Fay$$_($tmp1.car));var y = Fay$$index(1,Fay$$_($tmp1.car));var z = Fay$$index(2,Fay$$_($tmp1.car));var ps = $tmp1.cdr;return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),3)) {var xs = Fay$$index(0,Fay$$_($tmp1));var ys = Fay$$index(1,Fay$$_($tmp1));var zs = Fay$$index(2,Fay$$_($tmp1));return Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(x))(xs),Fay$$_(Fay$$_(Fay$$cons)(y))(ys),Fay$$_(Fay$$_(Fay$$cons)(z))(zs)]);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Prelude.unzip3)(ps));}}if (Fay$$_($p1) === null) {return Fay$$list([null,null,null]);}throw ["unhandled case in unzip3",[$p1]];});};Prelude.lines = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return null;}var s = $p1;return (function(){var isLineBreak = function($p1){return new Fay$$$(function(){var c = $p1;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(Fay$$_(Fay$$eq)(c))("\r")))(Fay$$_(Fay$$_(Fay$$eq)(c))("\n"));});};return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var a = Fay$$index(0,Fay$$_($tmp1));if (Fay$$_(Fay$$index(1,Fay$$_($tmp1))) === null) {return Fay$$list([a]);}}if (Fay$$listLen(Fay$$_($tmp1),2)) {var a = Fay$$index(0,Fay$$_($tmp1));var $tmp2 = Fay$$_(Fay$$index(1,Fay$$_($tmp1)));if ($tmp2 instanceof Fay$$Cons) {var cs = $tmp2.cdr;return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Prelude.lines)(cs));}}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.$_break)(isLineBreak))(s));})();});};Prelude.unlines = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return null;}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var l = $tmp1.car;var ls = $tmp1.cdr;return Fay$$_(Fay$$_(Prelude.$43$$43$)(l))(Fay$$_(Fay$$_(Fay$$cons)("\n"))(Fay$$_(Prelude.unlines)(ls)));}throw ["unhandled case in unlines",[$p1]];});};Prelude.words = function($p1){return new Fay$$$(function(){var str = $p1;return (function(){var words$39$ = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return null;}var s = $p1;return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var a = Fay$$index(0,Fay$$_($tmp1));var b = Fay$$index(1,Fay$$_($tmp1));return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Prelude.words)(b));}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.$_break)(isSpace))(s));});};var isSpace = function($p1){return new Fay$$$(function(){var c = $p1;return Fay$$_(Fay$$_(Prelude.elem)(c))(Fay$$list(" \t\r\n\u000c\u000b"));});};return Fay$$_(words$39$)(Fay$$_(Fay$$_(Prelude.dropWhile)(isSpace))(str));})();});};Prelude.unwords = new Fay$$$(function(){return Fay$$_(Prelude.intercalate)(Fay$$list(" "));});Prelude.and = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return true;}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$and)(x))(Fay$$_(Prelude.and)(xs));}throw ["unhandled case in and",[$p1]];});};Prelude.or = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return false;}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$or)(x))(Fay$$_(Prelude.or)(xs));}throw ["unhandled case in or",[$p1]];});};Prelude.any = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return false;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(p)(x)))(Fay$$_(Fay$$_(Prelude.any)(p))(xs));}throw ["unhandled case in any",[$p1,$p2]];});};};Prelude.all = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return true;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var p = $p1;return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(p)(x)))(Fay$$_(Fay$$_(Prelude.all)(p))(xs));}throw ["unhandled case in all",[$p1,$p2]];});};};Prelude.intersperse = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var sep = $p1;return Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.prependToAll)(sep))(xs));}throw ["unhandled case in intersperse",[$p1,$p2]];});};};Prelude.prependToAll = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var sep = $p1;return Fay$$_(Fay$$_(Fay$$cons)(sep))(Fay$$_(Fay$$_(Fay$$cons)(x))(Fay$$_(Fay$$_(Prelude.prependToAll)(sep))(xs)));}throw ["unhandled case in prependToAll",[$p1,$p2]];});};};Prelude.intercalate = function($p1){return function($p2){return new Fay$$$(function(){var xss = $p2;var xs = $p1;return Fay$$_(Prelude.concat)(Fay$$_(Fay$$_(Prelude.intersperse)(xs))(xss));});};};Prelude.maximum = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("maximum: empty list"));}var xs = $p1;return Fay$$_(Fay$$_(Prelude.foldl1)(Prelude.max))(xs);});};Prelude.minimum = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Fay$$_(Prelude.error)(Fay$$list("minimum: empty list"));}var xs = $p1;return Fay$$_(Fay$$_(Prelude.foldl1)(Prelude.min))(xs);});};Prelude.product = function($p1){return new Fay$$$(function(){var xs = $p1;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(Fay$$mult))(1))(xs);});};Prelude.sum = function($p1){return new Fay$$$(function(){var xs = $p1;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(Fay$$add))(0))(xs);});};Prelude.scanl = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var l = $p3;var z = $p2;var f = $p1;return Fay$$_(Fay$$_(Fay$$cons)(z))((function($tmp1){if (Fay$$_($tmp1) === null) {return null;}var $tmp2 = Fay$$_($tmp1);if ($tmp2 instanceof Fay$$Cons) {var x = $tmp2.car;var xs = $tmp2.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.scanl)(f))(Fay$$_(Fay$$_(f)(z))(x)))(xs);}return (function(){ throw (["unhandled case",$tmp1]); })();})(l));});};};};Prelude.scanl1 = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(Fay$$_(Prelude.scanl)(f))(x))(xs);}throw ["unhandled case in scanl1",[$p1,$p2]];});};};Prelude.scanr = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) === null) {var z = $p2;return Fay$$list([z]);}var $tmp1 = Fay$$_($p3);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var z = $p2;var f = $p1;return (function($tmp1){var $tmp2 = Fay$$_($tmp1);if ($tmp2 instanceof Fay$$Cons) {var h = $tmp2.car;var t = $tmp2.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(f)(x))(h)))(Fay$$_(Fay$$_(Fay$$cons)(h))(t));}return Prelude.$_undefined;})(Fay$$_(Fay$$_(Fay$$_(Prelude.scanr)(f))(z))(xs));}throw ["unhandled case in scanr",[$p1,$p2,$p3]];});};};};Prelude.scanr1 = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}if (Fay$$listLen(Fay$$_($p2),1)) {var x = Fay$$index(0,Fay$$_($p2));return Fay$$list([x]);}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return (function($tmp1){var $tmp2 = Fay$$_($tmp1);if ($tmp2 instanceof Fay$$Cons) {var h = $tmp2.car;var t = $tmp2.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(f)(x))(h)))(Fay$$_(Fay$$_(Fay$$cons)(h))(t));}return Prelude.$_undefined;})(Fay$$_(Fay$$_(Prelude.scanr1)(f))(xs));}throw ["unhandled case in scanr1",[$p1,$p2]];});};};Prelude.lookup = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {var _key = $p1;return Prelude.Nothing;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {if (Fay$$listLen(Fay$$_($tmp1.car),2)) {var x = Fay$$index(0,Fay$$_($tmp1.car));var y = Fay$$index(1,Fay$$_($tmp1.car));var xys = $tmp1.cdr;var key = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(key))(x)) ? Fay$$_(Prelude.Just)(y) : Fay$$_(Fay$$_(Prelude.lookup)(key))(xys);}}throw ["unhandled case in lookup",[$p1,$p2]];});};};Prelude.length = function($p1){return new Fay$$$(function(){var xs = $p1;return Fay$$_(Fay$$_(Prelude.length$39$)(0))(xs);});};Prelude.length$39$ = function($p1){return function($p2){return new Fay$$$(function(){var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var xs = $tmp1.cdr;var acc = $p1;return Fay$$_(Fay$$_(Prelude.length$39$)(Fay$$_(Fay$$_(Fay$$add)(acc))(1)))(xs);}var acc = $p1;return acc;});};};Prelude.reverse = function($p1){return new Fay$$$(function(){var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$_(Prelude.reverse)(xs)))(Fay$$list([x]));}if (Fay$$_($p1) === null) {return null;}throw ["unhandled case in reverse",[$p1]];});};Prelude.print = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],(function(x) { if (console && console.log) console.log(x) })(Fay$$fayToJs(["automatic"],$p1))));});};Prelude.putStrLn = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],(function(x) { if (console && console.log) console.log(x) })(Fay$$fayToJs_string($p1))));});};Prelude.ifThenElse = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var b = $p3;var a = $p2;var p = $p1;return Fay$$_(p) ? a : b;});};};};Fay$$objConcat(Fay$$fayToJsHash,{"Just": function(type,argTypes,_obj){var obj_ = {"instance": "Just"};var obj_slot1 = Fay$$fayToJs(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],_obj.slot1);if (undefined !== obj_slot1) {obj_['slot1'] = obj_slot1;}return obj_;},"Nothing": function(type,argTypes,_obj){var obj_ = {"instance": "Nothing"};return obj_;},"Left": function(type,argTypes,_obj){var obj_ = {"instance": "Left"};var obj_slot1 = Fay$$fayToJs(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],_obj.slot1);if (undefined !== obj_slot1) {obj_['slot1'] = obj_slot1;}return obj_;},"Right": function(type,argTypes,_obj){var obj_ = {"instance": "Right"};var obj_slot1 = Fay$$fayToJs(argTypes && (argTypes)[1] ? (argTypes)[1] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],_obj.slot1);if (undefined !== obj_slot1) {obj_['slot1'] = obj_slot1;}return obj_;},"GT": function(type,argTypes,_obj){var obj_ = {"instance": "GT"};return obj_;},"LT": function(type,argTypes,_obj){var obj_ = {"instance": "LT"};return obj_;},"EQ": function(type,argTypes,_obj){var obj_ = {"instance": "EQ"};return obj_;}});Fay$$objConcat(Fay$$jsToFayHash,{"Just": function(type,argTypes,obj){return new Prelude._Just(Fay$$jsToFay(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],obj["slot1"]));},"Nothing": function(type,argTypes,obj){return new Prelude._Nothing();},"Left": function(type,argTypes,obj){return new Prelude._Left(Fay$$jsToFay(argTypes && (argTypes)[0] ? (argTypes)[0] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],obj["slot1"]));},"Right": function(type,argTypes,obj){return new Prelude._Right(Fay$$jsToFay(argTypes && (argTypes)[1] ? (argTypes)[1] : (type)[0] === "automatic" ? ["automatic"] : ["unknown"],obj["slot1"]));},"GT": function(type,argTypes,obj){return new Prelude._GT();},"LT": function(type,argTypes,obj){return new Prelude._LT();},"EQ": function(type,argTypes,obj){return new Prelude._EQ();}});var FFI = {};Data.Nullable = {};Data.Nullable.fromNullable = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Fay.FFI._Nullable) {var x = Fay$$_($p1).slot1;return Fay$$_(Prelude.Just)(x);}if (Fay$$_($p1) instanceof Fay.FFI._Null) {return Prelude.Nothing;}throw ["unhandled case in fromNullable",[$p1]];});};Data.Nullable.toNullable = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Just) {var x = Fay$$_($p1).slot1;return Fay$$_(Fay.FFI.Nullable)(x);}if (Fay$$_($p1) instanceof Prelude._Nothing) {return Fay.FFI.Null;}throw ["unhandled case in toNullable",[$p1]];});};Data.Text = {};Data.Text.intercalate = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],$p2).join(Fay$$fayToJs(["user","Text",[]],$p1)));});};};Data.Text.fromString = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_string($p1));});};Data.Text.snoc = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1) + Fay$$fayToJs(["user","Char",[]],$p2));});};};Data.Text.cons = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Char",[]],$p1) + Fay$$fayToJs(["user","Text",[]],$p2));});};};Data.Text.pack = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_string($p1));});};Data.Text.unpack = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_string(Fay$$fayToJs(["user","Text",[]],$p1));});};Data.Text.append = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1) + Fay$$fayToJs(["user","Text",[]],$p2));});};};Data.Text.$60$$62$ = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1) + Fay$$fayToJs(["user","Text",[]],$p2));});};};Data.Text.length = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs(["user","Text",[]],$p1).length);});};Data.Text.$_null = function($p1){return new Fay$$$(function(){return Fay$$jsToFay_bool(Fay$$fayToJs(["user","Text",[]],$p1).length == 0);});};Data.Text.take = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p2).substring(0,Fay$$fayToJs_int($p1)));});};};Data.Text.drop = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p2).substring(Fay$$fayToJs_int($p1)));});};};Data.Text.empty = new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],"");});Data.Text.lines = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Text",[]]]],Fay$$fayToJs(["user","Text",[]],$p1).split('\n'));});};Data.Text.unlines = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],$p1).join('\n'));});};Data.Text.isPrefixOf = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay_bool(Fay$$fayToJs(["user","Text",[]],$p2).lastIndexOf(Fay$$fayToJs(["user","Text",[]],$p1), 0) == 0);});};};Data.Text.intersperse = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p2).split('').join(Fay$$fayToJs(["user","Char",[]],$p1)));});};};Data.Text.reverse = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1).split('').reverse().join(''));});};Data.Text.stripSuffix = function($p1){return function($p2){return new Fay$$$(function(){var text = $p2;var prefix = $p1;return (function(){var extract = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["nullable",[["user","Text",[]]]],(function(suffix,text){ return text.substring(text.length - suffix.length) == suffix? text.substring(0,text.length - suffix.length) : null; })(Fay$$fayToJs(["user","Text",[]],$p1),Fay$$fayToJs(["user","Text",[]],$p2)));});};};return Fay$$_(Data.Nullable.fromNullable)(Fay$$_(Fay$$_(extract)(prefix))(text));})();});};};Data.Text.splitOn = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Text",[]]]],Fay$$fayToJs(["user","Text",[]],$p2).split(Fay$$fayToJs(["user","Text",[]],$p1)));});};};Data.Text.putStrLn = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],console.log('%s',Fay$$fayToJs(["user","Text",[]],$p1))));});};Data.Text.toShortest = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_double($p1).toString());});};Data.Text.showInt = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_int($p1).toString());});};Data.Text.uncons = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Maybe",[["tuple",[["user","Char",[]],["user","Text",[]]]]]],Fay$$fayToJs(["user","Text",[]],$p1)[0] ? { instance: 'Just', slot1 : [Fay$$fayToJs(["user","Text",[]],$p1)[0],Fay$$fayToJs(["user","Text",[]],$p1).slice(1)] } : { instance : 'Nothing' });});};Data.Text.head = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Char",[]],Fay$$fayToJs(["user","Text",[]],$p1)[0] || (function () {throw new Error('Data.Text.head: empty Text'); }()));});};Data.Text.last = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Char",[]],Fay$$fayToJs(["user","Text",[]],$p1).length ? Fay$$fayToJs(["user","Text",[]],$p1)[Fay$$fayToJs(["user","Text",[]],$p1).length-1] : (function() { throw new Error('Data.Text.last: empty Text') })());});};Data.Text.tail = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1).length ? Fay$$fayToJs(["user","Text",[]],$p1).slice(1) : (function () { throw new Error('Data.Text.tail: empty Text') })());});};Data.Text.init = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1).length ? Fay$$fayToJs(["user","Text",[]],$p1).slice(0,-1) : (function () { throw new Error('Data.Text.init: empty Text') })());});};Data.Text.map = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],[].map.call(Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["function",[["user","Char",[]],["user","Char",[]]]],$p1)).join(''));});};};Data.Text.toLower = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1).toLowerCase());});};Data.Text.toUpper = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],$p1).toUpperCase());});};Data.Text.concat = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],$p1).join(''));});};Data.Text.concatMap = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],[].map.call(Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["function",[["user","Char",[]],["user","Text",[]]]],$p1)).join(''));});};};Data.Text.any = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay_bool([].filter.call(Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],$p1)).length > 0);});};};Data.Text.all = function($p1){return function($p2){return new Fay$$$(function(){return Fay$$jsToFay_bool([].filter.call(Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],$p1)).length == Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],$p1).length);});};};Data.Text.maximum = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Char",[]],(function (s) {    if (s === '') { throw new Error('Data.Text.maximum: empty string'); }    var max = s[0];    for (var i = 1; i < s.length; s++) {      if (s[i] > max) { max = s[i]; }    }    return max;  })(Fay$$fayToJs(["user","Text",[]],$p1)));});};Data.Text.minimum = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["user","Char",[]],(function (s) {    if (s === '') { throw new Error('Data.Text.maximum: empty string'); }    var min = s[0];    for (var i = 1; i < s.length; s++) {      if (s[i] < min) { min = s[i]; }    }    return min;  })(Fay$$fayToJs(["user","Text",[]],$p1)));});};var DOM = {};DOM.getWindow = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Global",[]],window));});DOM.getDocument = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Document",[]],window.document));});DOM.getBody = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document.body));});DOM.getElementById = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document['getElementById'](Fay$$fayToJs(["user","Text",[]],$p1))));});};DOM.getElementsByName = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["list",[["user","Element",[]]]],document['getElementsByName'](Fay$$fayToJs(["user","Text",[]],$p1))));});};DOM.addEvent = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window['addEventListener'](Fay$$fayToJs(["user","Text",[]],$p1),Fay$$fayToJs(["action",[["unknown"]]],$p2))));});};};DOM.removeEvent = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['removeEventListener'](Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],$p3))));});};};};DOM.stopProp = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Event",[]],$p1)['stopPropagation']()));});};DOM.preventDefault = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Event",[]],$p1)['preventDefault']()));});};DOM.createElement = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],window['document']['createElement'](Fay$$fayToJs(["user","Text",[]],$p1))));});};DOM.appendChild = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['appendChild'](Fay$$fayToJs(["user","Element",[]],$p2))));});};};DOM.appendChildBefore = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['parentNode']['insertBefore'](Fay$$fayToJs(["user","Element",[]],$p2), Fay$$fayToJs(["user","Element",[]],$p1))));});};};DOM.removeChild = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['removeChild'](Fay$$fayToJs(["user","Element",[]],$p2))));});};};DOM.parentNode = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1)['parentNode']));});};DOM.children = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","NodeList",[]],Fay$$fayToJs(["user","Element",[]],$p1)['children']));});};DOM.childNodes = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","NodeList",[]],Fay$$fayToJs(["user","Element",[]],$p1)['childNodes']));});};DOM.nodeListToArray = function($p1){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Element",[]]]],Array.prototype.slice.call(Fay$$fayToJs(["user","NodeList",[]],$p1)));});};DOM.nodesBetween = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["list",[["user","Element",[]]]],(function(start, end) {  var i, contents, result = [], parentNode = start.parentNode;  if(parentNode !== end.parentNode) return;  contents = Array.prototype.slice.call(parentNode.childNodes);  for(i=contents.indexOf(start); i<contents.indexOf(end); i++) {    result.push(contents[i]);  }})(Fay$$fayToJs(["user","Element",[]],$p1), Fay$$fayToJs(["user","Element",[]],$p2))));});};};DOM.removeNodesBetween = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],(function(start, end) {  var i, contents, parentNode = start.parentNode;  if(parentNode !== end.parentNode) return;  contents = Array.prototype.slice.call(parentNode.childNodes);  for(i=contents.indexOf(start); i<contents.indexOf(end); i++) {    parentNode.removeChild(contents[i]);  }})(Fay$$fayToJs(["user","Element",[]],$p1), Fay$$fayToJs(["user","Element",[]],$p2))));});};};DOM.createTextNode = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document['createTextNode'](Fay$$fayToJs(["user","Text",[]],$p1))));});};DOM.getTextData = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],$p1)['data']));});};DOM.setTextData = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['data'] = Fay$$fayToJs(["user","Text",[]],$p2)));});};};DOM.clearInnerHtml = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['innerHTML'] = ''));});};DOM.klass = new Fay$$$(function(){return DOM.addClass;});DOM.addClass = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1).classList['add'](Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.removeClass = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['classList']['remove'](Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.toggleClass = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['classList']['toggle'](Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.hasClass = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_bool(Fay$$fayToJs(["user","Element",[]],$p1)['classList']['contains'](Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.setAttr = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['setAttribute'](Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["user","Text",[]],$p3))));});};};};DOM.getAttr = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],$p1)['getAttribute'](Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.hasAttr = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_bool(Fay$$fayToJs(["user","Element",[]],$p1)['hasAttribute'](Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.getValue = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],$p1)['value']));});};DOM.setValue = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['value'] = Fay$$fayToJs(["user","Text",[]],$p2)));});};};DOM.isChecked = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_bool(Fay$$fayToJs(["user","Element",[]],$p1)['checked']));});};DOM.setChecked = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1)['checked'] = Fay$$fayToJs_bool($p2)));});};};DOM.getRadioValue = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],(function(name) {  var i, rs = document.getElementsByName(name);  if(rs) {    for(var i=0; i<rs.length; i++) {      var radio = rs[i];      if(radio.type === 'radio' && radio.checked)        return radio.value;    }  }})(Fay$$fayToJs(["user","Text",[]],$p1))));});};DOM.setRadioValue = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],(function(name, val) {  var i, rs = document.getElementsByName(name);  if(rs) {    for(var i=0; i<rs.length; i++) {      var radio = rs[i];      if(radio.type === 'radio' && radio.value === val)        radio.checked = true;    }  }})(Fay$$fayToJs(["user","Text",[]],$p1), Fay$$fayToJs(["user","Text",[]],$p2))));});};};DOM.getCurrentUrl = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],window['location']['href']));});DOM.logS = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],console['log'](Fay$$fayToJs(["user","Text",[]],$p1))));});};DOM.logF = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],console['log'](Fay$$fayToJs(["unknown"],$p1))));});};DOM.setInterval = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Timer",[]],(function (f,i) { var id = window['setInterval'](function () { f(id); }, i); return id; })(Fay$$fayToJs(["function",[["user","Timer",[]],["action",[["unknown"]]]]],$p2),Fay$$fayToJs_double($p1))));});};};DOM.clearInterval = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window['clearInterval'](Fay$$fayToJs(["user","Timer",[]],$p1))));});};DOM.setTimeout = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Timer",[]],(function (f,i) { var id = window['setTimeout'](function () { f(id); }, i); return id; })(Fay$$fayToJs(["function",[["user","Timer",[]],["action",[["unknown"]]]]],$p2),Fay$$fayToJs_double($p1))));});};};DOM.clearTimeout = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window['clearTimeout'](Fay$$fayToJs(["user","Timer",[]],$p1))));});};DOM._GET = function GET(){};DOM._GET.prototype.instance = "GET";DOM.GET = new Fay$$$(function(){return new DOM._GET();});DOM._POST = function POST(){};DOM._POST.prototype.instance = "POST";DOM.POST = new Fay$$$(function(){return new DOM._POST();});DOM._PUT = function PUT(){};DOM._PUT.prototype.instance = "PUT";DOM.PUT = new Fay$$$(function(){return new DOM._PUT();});DOM._HEAD = function HEAD(){};DOM._HEAD.prototype.instance = "HEAD";DOM.HEAD = new Fay$$$(function(){return new DOM._HEAD();});DOM._UNSENT = function UNSENT(){};DOM._UNSENT.prototype.instance = "UNSENT";DOM.UNSENT = new Fay$$$(function(){return new DOM._UNSENT();});DOM._OPENED = function OPENED(){};DOM._OPENED.prototype.instance = "OPENED";DOM.OPENED = new Fay$$$(function(){return new DOM._OPENED();});DOM._HEADERS_RECEIVED = function HEADERS_RECEIVED(){};DOM._HEADERS_RECEIVED.prototype.instance = "HEADERS_RECEIVED";DOM.HEADERS_RECEIVED = new Fay$$$(function(){return new DOM._HEADERS_RECEIVED();});DOM._LOADING = function LOADING(){};DOM._LOADING.prototype.instance = "LOADING";DOM.LOADING = new Fay$$$(function(){return new DOM._LOADING();});DOM._DONE = function DONE(){};DOM._DONE.prototype.instance = "DONE";DOM.DONE = new Fay$$$(function(){return new DOM._DONE();});DOM.xmlHttpRequest = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","XMLHttpRequest",[]],(function(window) { if(window['XMLHttpRequest']) return new XMLHttpRequest(); else return new ActiveXObject('Microsoft.XMLHTTP'); })(window)));});DOM.open = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","XMLHttpRequest",[]],(function(method, url, xhr) { xhr['open'](method['instance'], url, true); return xhr; })(Fay$$fayToJs(["user","RequestMethod",[]],$p1), Fay$$fayToJs(["user","Text",[]],$p2), Fay$$fayToJs(["user","XMLHttpRequest",[]],$p3))));});};};};DOM.send = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","XMLHttpRequest",[]],$p1)['send']()));});};DOM.setReadyStateHandler = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","XMLHttpRequest",[]],(function(handler, xhr) { xhr['onreadystatechange'] = function() { handler(xhr); }; return xhr; })(Fay$$fayToJs(["function",[["user","XMLHttpRequest",[]],["action",[["unknown"]]]]],$p1), Fay$$fayToJs(["user","XMLHttpRequest",[]],$p2))));});};};DOM.readyState = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","ReadyState",[]],{ instance: ['UNSENT', 'OPENED', 'HEADERS_RECEIVED', 'LOADING', 'DONE'][Fay$$fayToJs(["user","XMLHttpRequest",[]],$p1)['readyState']] }));});};DOM.responseText = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","XMLHttpRequest",[]],$p1)['responseText']));});};DOM.status = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(Fay$$fayToJs(["user","XMLHttpRequest",[]],$p1)['status']));});};DOM.parseInt = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(parseInt(Fay$$fayToJs(["user","Text",[]],$p1), 10)));});};DOM.scrollIntoView = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1).scrollIntoView()));});};DOM.scrollRelative = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.scrollBy(0,Fay$$fayToJs_int($p1))));});};DOM.scrollAbsolute = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.scrollTo(0,Fay$$fayToJs_int($p1))));});};Fay$$objConcat(Fay$$fayToJsHash,{"GET": function(type,argTypes,_obj){var obj_ = {"instance": "GET"};return obj_;},"POST": function(type,argTypes,_obj){var obj_ = {"instance": "POST"};return obj_;},"PUT": function(type,argTypes,_obj){var obj_ = {"instance": "PUT"};return obj_;},"HEAD": function(type,argTypes,_obj){var obj_ = {"instance": "HEAD"};return obj_;},"UNSENT": function(type,argTypes,_obj){var obj_ = {"instance": "UNSENT"};return obj_;},"OPENED": function(type,argTypes,_obj){var obj_ = {"instance": "OPENED"};return obj_;},"HEADERS_RECEIVED": function(type,argTypes,_obj){var obj_ = {"instance": "HEADERS_RECEIVED"};return obj_;},"LOADING": function(type,argTypes,_obj){var obj_ = {"instance": "LOADING"};return obj_;},"DONE": function(type,argTypes,_obj){var obj_ = {"instance": "DONE"};return obj_;}});Fay$$objConcat(Fay$$jsToFayHash,{"GET": function(type,argTypes,obj){return new DOM._GET();},"POST": function(type,argTypes,obj){return new DOM._POST();},"PUT": function(type,argTypes,obj){return new DOM._PUT();},"HEAD": function(type,argTypes,obj){return new DOM._HEAD();},"UNSENT": function(type,argTypes,obj){return new DOM._UNSENT();},"OPENED": function(type,argTypes,obj){return new DOM._OPENED();},"HEADERS_RECEIVED": function(type,argTypes,obj){return new DOM._HEADERS_RECEIVED();},"LOADING": function(type,argTypes,obj){return new DOM._LOADING();},"DONE": function(type,argTypes,obj){return new DOM._DONE();}});Data.Maybe = {};Data.Maybe.isJust = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Nothing) {return false;}return true;});};Data.Maybe.isNothing = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Nothing) {return true;}return false;});};Data.Maybe.fromJust = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Nothing) {return Fay$$_(Prelude.error)(Fay$$list("Maybe.fromJust: Nothing"));}if (Fay$$_($p1) instanceof Prelude._Just) {var x = Fay$$_($p1).slot1;return x;}throw ["unhandled case in fromJust",[$p1]];});};Data.Maybe.fromMaybe = function($p1){return function($p2){return new Fay$$$(function(){var x = $p2;var d = $p1;return (function($tmp1){if (Fay$$_($tmp1) instanceof Prelude._Nothing) {return d;}if (Fay$$_($tmp1) instanceof Prelude._Just) {var v = Fay$$_($tmp1).slot1;return v;}return (function(){ throw (["unhandled case",$tmp1]); })();})(x);});};};Data.Maybe.maybeToList = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Nothing) {return null;}if (Fay$$_($p1) instanceof Prelude._Just) {var x = Fay$$_($p1).slot1;return Fay$$list([x]);}throw ["unhandled case in maybeToList",[$p1]];});};Data.Maybe.listToMaybe = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Prelude.Nothing;}var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var a = $tmp1.car;return Fay$$_(Prelude.Just)(a);}throw ["unhandled case in listToMaybe",[$p1]];});};Data.Maybe.catMaybes = function($p1){return new Fay$$$(function(){var ls = $p1;return (function(){return new Fay$$$(function(){var $gen_0 = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Just) {var x = Fay$$_($p1).slot1;return Fay$$list([x]);}return null;});};return Fay$$_(Fay$$_(Prelude.concatMap)($gen_0))(ls);});})();});};Data.Maybe.mapMaybe = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return (function(){return new Fay$$$(function(){var rs = new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Maybe.mapMaybe)(f))(xs);});return (function($tmp1){if (Fay$$_($tmp1) instanceof Prelude._Nothing) {return rs;}if (Fay$$_($tmp1) instanceof Prelude._Just) {var r = Fay$$_($tmp1).slot1;return Fay$$_(Fay$$_(Fay$$cons)(r))(rs);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(f)(x));});})();}throw ["unhandled case in mapMaybe",[$p1,$p2]];});};};Data.Maybe.mapMaybeFB = function($p1){return function($p2){return function($p3){return function($p4){return new Fay$$$(function(){var next = $p4;var x = $p3;var f = $p2;var cons = $p1;return (function($tmp1){if (Fay$$_($tmp1) instanceof Prelude._Nothing) {return next;}if (Fay$$_($tmp1) instanceof Prelude._Just) {var r = Fay$$_($tmp1).slot1;return Fay$$_(Fay$$_(cons)(r))(next);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(f)(x));});};};};};Data.Maybe.whenJust = function($p1){return function($p2){return new Fay$$$(function(){var f = $p2;if (Fay$$_($p1) instanceof Prelude._Just) {var x = Fay$$_($p1).slot1;return Fay$$_(f)(x);}if (Fay$$_($p1) instanceof Prelude._Nothing) {return Fay$$_(Fay$$$_return)(Fay$$unit);}throw ["unhandled case in whenJust",[$p1,$p2]];});};};Data.Maybe.whenJust$39$ = function($p1){return function($p2){return new Fay$$$(function(){var f = $p2;if (Fay$$_($p1) instanceof Prelude._Just) {var x = Fay$$_($p1).slot1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(f)(x)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Prelude.Just));}if (Fay$$_($p1) instanceof Prelude._Nothing) {return Fay$$_(Fay$$$_return)(Prelude.Nothing);}throw ["unhandled case in whenJust'",[$p1,$p2]];});};};Data.Maybe.onJust = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) instanceof Prelude._Just) {var x = Fay$$_($p2).slot1;var f = $p1;return Fay$$_(Prelude.Just)(Fay$$_(f)(x));}if (Fay$$_($p2) instanceof Prelude._Nothing) {return Prelude.Nothing;}throw ["unhandled case in onJust",[$p1,$p2]];});};};Data.Maybe.joinMaybe = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Just) {if (Fay$$_(Fay$$_($p1).slot1) instanceof Prelude._Just) {var x = Fay$$_(Fay$$_($p1).slot1).slot1;return Fay$$_(Prelude.Just)(x);}}return Prelude.Nothing;});};Data.List = {};Data.List.isPrefixOf = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return true;}if (Fay$$_($p2) === null) {return false;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var y = $tmp1.car;var ys = $tmp1.cdr;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$eq)(x))(y)))(Fay$$_(Fay$$_(Data.List.isPrefixOf)(xs))(ys));}}throw ["unhandled case in isPrefixOf",[$p1,$p2]];});};};Data.List.isSuffixOf = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Data.List.isPrefixOf)(Fay$$_(Prelude.reverse)(x)))(Fay$$_(Prelude.reverse)(y));});};};Data.List.stripPrefix = function($p1){return function($p2){return new Fay$$$(function(){var ys = $p2;if (Fay$$_($p1) === null) {return Fay$$_(Prelude.Just)(ys);}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var y = $tmp1.car;var ys = $tmp1.cdr;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;if (Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(x))(y))) {return Fay$$_(Fay$$_(Data.List.stripPrefix)(xs))(ys);}}}return Prelude.Nothing;});};};Data.List.stripSuffix = function($p1){return function($p2){return new Fay$$$(function(){var y = $p2;var x = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.onJust)(Prelude.reverse)))(Fay$$_(Fay$$_(Data.List.stripPrefix)(Fay$$_(Prelude.reverse)(x)))(Fay$$_(Prelude.reverse)(y)));});};};Data.List.splitWhen = function($p1){return function($p2){return new Fay$$$(function(){var s = $p2;var p = $p1;return (function($tmp1){if (Fay$$_($tmp1) === null) {return null;}var s$39$ = $tmp1;return (function($tmp2){if (Fay$$listLen(Fay$$_($tmp2),2)) {var w = Fay$$index(0,Fay$$_($tmp2));var s$39$$39$ = Fay$$index(1,Fay$$_($tmp2));return Fay$$_(Fay$$_(Fay$$cons)(w))(Fay$$_(Fay$$_(Data.List.splitWhen)(p))(s$39$$39$));}return (function(){ throw (["unhandled case",$tmp2]); })();})(Fay$$_(Fay$$_(Prelude.$_break)(p))(s$39$));})(Fay$$_(Fay$$_(Prelude.dropWhile)(p))(s));});};};Data.List.splitOn = function($p1){return new Fay$$$(function(){var c = $p1;return Fay$$_(Data.List.splitWhen)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)($gen_0))(c);});});};Data.List.partition = function($p1){return function($p2){return new Fay$$$(function(){var xs = $p2;var p = $p1;return Fay$$list([Fay$$_(Fay$$_(Prelude.filter)(p))(xs),Fay$$_(Fay$$_(Prelude.filter)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.not))(p)))(xs)]);});};};Data.List.inits = function($p1){return new Fay$$$(function(){var xs = $p1;return Fay$$_(Fay$$_(Fay$$cons)(null))((function($tmp1){if (Fay$$_($tmp1) === null) {return null;}var $tmp2 = Fay$$_($tmp1);if ($tmp2 instanceof Fay$$Cons) {var x = $tmp2.car;var xs$39$ = $tmp2.cdr;return Fay$$_(Fay$$_(Prelude.map)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$cons)(x))($gen_0);}))(Fay$$_(Data.List.inits)(xs$39$));}return (function(){ throw (["unhandled case",$tmp1]); })();})(xs));});};Data.List.groupSortBy = function($p1){return new Fay$$$(function(){var f = $p1;return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.List.groupBy)(function($p1){var x = $p1;return function($p2){var y = $p2;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(f)(x))(y)))(Prelude.EQ);};})))(Fay$$_(Prelude.sortBy)(f));});};Data.List.groupBy = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return null;}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var eq = $p1;return (function($tmp1){if (Fay$$listLen(Fay$$_($tmp1),2)) {var ys = Fay$$index(0,Fay$$_($tmp1));var zs = Fay$$index(1,Fay$$_($tmp1));return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(Fay$$cons)(x))(ys)))(Fay$$_(Fay$$_(Data.List.groupBy)(eq))(zs));}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Prelude.span)(Fay$$_(eq)(x)))(xs));}throw ["unhandled case in groupBy",[$p1,$p2]];});};};Data.List.findM = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$_($p2) === null) {return Fay$$_(Fay$$$_return)(Prelude.Nothing);}var $tmp1 = Fay$$_($p2);if ($tmp1 instanceof Fay$$Cons) {var x = $tmp1.car;var xs = $tmp1.cdr;var f = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(f)(x)))(function($p1){var b = $p1;return (function($tmp1){if (Fay$$_($tmp1) instanceof Prelude._Nothing) {return Fay$$_(Fay$$_(Data.List.findM)(f))(xs);}if (Fay$$_($tmp1) instanceof Prelude._Just) {return Fay$$_(Fay$$$_return)(b);}return (function(){ throw (["unhandled case",$tmp1]); })();})(b);});}throw ["unhandled case in findM",[$p1,$p2]];});};};Data.Either = {};Data.Either.whenLeft = function($p1){return function($p2){return new Fay$$$(function(){var f = $p2;if (Fay$$_($p1) instanceof Prelude._Left) {var x = Fay$$_($p1).slot1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(f)(x)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Prelude.Just));}if (Fay$$_($p1) instanceof Prelude._Right) {return Fay$$_(Fay$$$_return)(Prelude.Nothing);}throw ["unhandled case in whenLeft",[$p1,$p2]];});};};Data.Either.whenRight = function($p1){return function($p2){return new Fay$$$(function(){var f = $p2;if (Fay$$_($p1) instanceof Prelude._Right) {var x = Fay$$_($p1).slot1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(f)(x)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Prelude.Just));}if (Fay$$_($p1) instanceof Prelude._Left) {return Fay$$_(Fay$$$_return)(Prelude.Nothing);}throw ["unhandled case in whenRight",[$p1,$p2]];});};};Data.Either.isLeft = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Left) {return true;}return false;});};Data.Either.isRight = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Right) {return true;}return false;});};var HTICjs = {};HTICjs._B = function B(bname,boption,boptionChosenState,bcontent,bnext,bdisplayOnNewPage,bautoContinue,baltContent,baltContentTimeout,brandomNext,bbuildFromTemplate,boverrideNext,bskipPastNext,brunCode){this.bname = bname;this.boption = boption;this.boptionChosenState = boptionChosenState;this.bcontent = bcontent;this.bnext = bnext;this.bdisplayOnNewPage = bdisplayOnNewPage;this.bautoContinue = bautoContinue;this.baltContent = baltContent;this.baltContentTimeout = baltContentTimeout;this.brandomNext = brandomNext;this.bbuildFromTemplate = bbuildFromTemplate;this.boverrideNext = boverrideNext;this.bskipPastNext = bskipPastNext;this.brunCode = brunCode;};HTICjs._B.prototype.instance = "B";HTICjs.B = function(bname){return function(boption){return function(boptionChosenState){return function(bcontent){return function(bnext){return function(bdisplayOnNewPage){return function(bautoContinue){return function(baltContent){return function(baltContentTimeout){return function(brandomNext){return function(bbuildFromTemplate){return function(boverrideNext){return function(bskipPastNext){return function(brunCode){return new Fay$$$(function(){return new HTICjs._B(bname,boption,boptionChosenState,bcontent,bnext,bdisplayOnNewPage,bautoContinue,baltContent,baltContentTimeout,brandomNext,bbuildFromTemplate,boverrideNext,bskipPastNext,brunCode);});};};};};};};};};};};};};};};HTICjs.bname = function(x){return new Fay$$$(function(){return Fay$$_(x).bname;});};HTICjs.boption = function(x){return new Fay$$$(function(){return Fay$$_(x).boption;});};HTICjs.boptionChosenState = function(x){return new Fay$$$(function(){return Fay$$_(x).boptionChosenState;});};HTICjs.bcontent = function(x){return new Fay$$$(function(){return Fay$$_(x).bcontent;});};HTICjs.bnext = function(x){return new Fay$$$(function(){return Fay$$_(x).bnext;});};HTICjs.bdisplayOnNewPage = function(x){return new Fay$$$(function(){return Fay$$_(x).bdisplayOnNewPage;});};HTICjs.bautoContinue = function(x){return new Fay$$$(function(){return Fay$$_(x).bautoContinue;});};HTICjs.baltContent = function(x){return new Fay$$$(function(){return Fay$$_(x).baltContent;});};HTICjs.baltContentTimeout = function(x){return new Fay$$$(function(){return Fay$$_(x).baltContentTimeout;});};HTICjs.brandomNext = function(x){return new Fay$$$(function(){return Fay$$_(x).brandomNext;});};HTICjs.bbuildFromTemplate = function(x){return new Fay$$$(function(){return Fay$$_(x).bbuildFromTemplate;});};HTICjs.boverrideNext = function(x){return new Fay$$$(function(){return Fay$$_(x).boverrideNext;});};HTICjs.bskipPastNext = function(x){return new Fay$$$(function(){return Fay$$_(x).bskipPastNext;});};HTICjs.brunCode = function(x){return new Fay$$$(function(){return Fay$$_(x).brunCode;});};HTICjs.emptyBranch = new Fay$$$(function(){var _b = new HTICjs._B();_b.bname = Fay$$list("branchEmpty");_b.boption = Fay$$list("");_b.boptionChosenState = Prelude.Nothing;_b.bcontent = Fay$$list("");_b.bnext = null;_b.bdisplayOnNewPage = false;_b.bautoContinue = Prelude.Nothing;_b.baltContent = Prelude.Nothing;_b.brandomNext = false;_b.bbuildFromTemplate = Prelude.Nothing;_b.boverrideNext = Prelude.Nothing;_b.bskipPastNext = null;_b.brunCode = Prelude.Nothing;return _b;});HTICjs._C = function C(cbranches,cAutoContinueTimers,cEdit,cDontUpdateEditListener,cDontRemoveOptions){this.cbranches = cbranches;this.cAutoContinueTimers = cAutoContinueTimers;this.cEdit = cEdit;this.cDontUpdateEditListener = cDontUpdateEditListener;this.cDontRemoveOptions = cDontRemoveOptions;};HTICjs._C.prototype.instance = "C";HTICjs.C = function(cbranches){return function(cAutoContinueTimers){return function(cEdit){return function(cDontUpdateEditListener){return function(cDontRemoveOptions){return new Fay$$$(function(){return new HTICjs._C(cbranches,cAutoContinueTimers,cEdit,cDontUpdateEditListener,cDontRemoveOptions);});};};};};};HTICjs.cbranches = function(x){return new Fay$$$(function(){return Fay$$_(x).cbranches;});};HTICjs.cAutoContinueTimers = function(x){return new Fay$$$(function(){return Fay$$_(x).cAutoContinueTimers;});};HTICjs.cEdit = function(x){return new Fay$$$(function(){return Fay$$_(x).cEdit;});};HTICjs.cDontUpdateEditListener = function(x){return new Fay$$$(function(){return Fay$$_(x).cDontUpdateEditListener;});};HTICjs.cDontRemoveOptions = function(x){return new Fay$$$(function(){return Fay$$_(x).cDontRemoveOptions;});};HTICjs.emptyContext = new Fay$$$(function(){var _c = new HTICjs._C();_c.cbranches = null;_c.cAutoContinueTimers = null;_c.cEdit = (function(){var $36$_record_to_update = Object.create(Fay$$_(HTICjs.emptyBranch));$36$_record_to_update.bname = Fay$$list("edit");$36$_record_to_update.bdisplayOnNewPage = true;return $36$_record_to_update;})();_c.cDontUpdateEditListener = false;_c.cDontRemoveOptions = false;return _c;});HTICjs.$94$$46$ = function($p1){return function($p2){return new Fay$$$(function(){var a = $p2;var d = $p1;return Fay$$_(a)(d);});};};HTICjs.setCbranches = function($p1){return function($p2){return new Fay$$$(function(){var c = $p2;var d = $p1;return (function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cbranches = d;return $36$_record_to_update;})();});};};HTICjs.setCautoContinueTimers = function($p1){return function($p2){return new Fay$$$(function(){var c = $p2;var d = $p1;return (function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cAutoContinueTimers = d;return $36$_record_to_update;})();});};};HTICjs.addWindowEvent = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.addEventListener(Fay$$fayToJs_string($p1), Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],$p2))));});};};HTICjs.addEventListener = function($p1){return function($p2){return function($p3){return function($p4){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["unknown"],$p1)['addEventListener'](Fay$$fayToJs_string($p2),Fay$$fayToJs(["action",[["unknown"]]],$p3),Fay$$fayToJs_bool($p4))));});};};};};HTICjs.appendChild$39$ = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1).appendChild(Fay$$fayToJs(["user","Element",[]],$p2))));});};};HTICjs.createElement$39$ = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document.createElement(Fay$$fayToJs_string($p1))));});};HTICjs.getInnerHtml = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_string(Fay$$fayToJs(["user","Element",[]],$p1)['innerHTML']));});};HTICjs.getOuterHtml = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_string(Fay$$fayToJs(["user","Element",[]],$p1)['outerHTML']));});};HTICjs.getInnerHtml$39$ = function($p1){return new Fay$$$(function(){var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(DOM.nodeListToArray)))(Fay$$_(DOM.children)(e));});};HTICjs.setInnerHtml = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1)['innerHTML'] = Fay$$fayToJs_string($p2)));});};};HTICjs.setOuterHTML = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1)['outerHTML'] = Fay$$fayToJs_string($p2)));});};};HTICjs.setAttribute = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1).setAttribute(Fay$$fayToJs_string($p2), Fay$$fayToJs_string($p3))));});};};};HTICjs.getAttribute = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_string(Fay$$fayToJs(["user","Element",[]],$p1)[Fay$$fayToJs_string($p2)]));});};};HTICjs.hasAttribute = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_bool(Fay$$fayToJs(["user","Element",[]],$p1)[Fay$$fayToJs_string($p2)]));});};};HTICjs.removeAttribute = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1).removeAttribute(Fay$$fayToJs_string($p2))));});};};HTICjs.removeElement = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1).remove()));});};HTICjs.getLastChild = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1)['lastChild']));});};HTICjs.getFirstChild = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1)['firstChild']));});};HTICjs.replaceChild = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1).replaceChild(Fay$$fayToJs(["user","Element",[]],$p2),Fay$$fayToJs(["user","Element",[]],$p3))));});};};};HTICjs.childElementCount = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(Fay$$fayToJs(["user","Element",[]],$p1)['childElementCount']));});};HTICjs.children_l = function($p1){return new Fay$$$(function(){var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(DOM.nodeListToArray)))(Fay$$_(DOM.children)(e));});};HTICjs.hasChildNodes = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_bool(Fay$$fayToJs(["user","Element",[]],$p1)['hasChildNodes']));});};HTICjs.cloneNode = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],$p1).cloneNode(Fay$$fayToJs_bool($p2))));});};};HTICjs.getElementById$39$ = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document.getElementById(Fay$$fayToJs_string($p1))));});};HTICjs.getAllWithGivenValue = function($p1){return new Fay$$$(function(){var v = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom))(v)))(DOM.getBody);});};HTICjs.getAllWithGivenValueFrom = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var e = $p1;return Fay$$_(Fay$$_(HTICjs.getAllWithValueMatchingPredicateFrom)(e))(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)(v))($gen_0);});});};};HTICjs.getAllWithGivenValueFrom_l = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var e = $p1;return Fay$$_(Fay$$_(HTICjs.getAllWithValueMatchingPredicateFrom_l)(e))(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)(v))($gen_0);});});};};HTICjs.getAllWithValueMatchingPredicateFrom = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithValueMatchingPredicateFrom_l))(v)))(Fay$$_(HTICjs.children_l)(e));});};};HTICjs.getAllWithValueMatchingPredicateFrom_l = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getAllWithValue_from_l)(e)))(function($p1){var d = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAttribute))(Fay$$list("value"))))(d)))(function($p1){var dv = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(Fay$$_(Fay$$_(Prelude.$46$)(v))(Prelude.fst))))(Fay$$_(Fay$$_(Prelude.zip)(dv))(d)));});});});};};HTICjs.offsetHeight = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(Fay$$fayToJs(["user","Element",[]],$p1)['offsetHeight']));});};HTICjs.window_innerHeight = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(window.innerHeight));});HTICjs.setTimeout$39$ = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Timer",[]],window.setTimeout(Fay$$fayToJs(["action",[["unknown"]]],$p1), Fay$$fayToJs_int($p2))));});};};HTICjs.clearTimeout$39$ = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.clearTimeout(Fay$$fayToJs(["user","Timer",[]],$p1))));});};HTICjs.alert = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.alert(Fay$$fayToJs_string($p1))));});};HTICjs.getRandom = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],randomItem(Fay$$fayToJs(["list",[["unknown"]]],$p1))));});};HTICjs.shuffle = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["list",[["unknown"]]],shuffle(Fay$$fayToJs(["list",[["unknown"]]],$p1))));});};HTICjs.scrollIntoView$39$ = function($p1){return function($p2){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],$p1).scrollIntoView(Fay$$fayToJs_bool($p2))));});};};HTICjs.scrollIntoView$39$$39$ = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Data.Maybe.fromMaybe)(0))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(HTICjs.getIntSetting)(Fay$$list("scrollIntoView"))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("settings")))))))(function($p1){var doRun = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$eq)(doRun))(1))))(Fay$$_(Fay$$_(HTICjs.scrollIntoView$39$)(e))(b));});});};};HTICjs.runCode = function($p1){return new Fay$$$(function(){var code = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Prelude.putStrLn)(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("runCode ffi: ")))(Fay$$_(Fay$$_(Prelude.take)(100))(code)))))(Fay$$_(HTICjs.runCode$39$)(code));});};HTICjs.runCode$39$ = function($p1){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],runCode(Fay$$fayToJs_string($p1))));});};HTICjs.sanityCheck = function($p1){return new Fay$$$(function(){var allBranches = $p1;return (function(){var checkBranch = function($p1){return new Fay$$$(function(){var b = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.zip)(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.repeat))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname)))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.map)(Prelude.fst)))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.isNothing))(Prelude.snd))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.zip)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.map)(Fay$$_(HTICjs.getBranchByName)(allBranches))))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext))))));});};var checkBranchReachebility = function($p1){return function($p2){return new Fay$$$(function(){var allBranches = $p2;var allOptionsOnDisplay = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.map)(Prelude.fst)))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.isNothing))(Prelude.snd))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.zip)(Fay$$_(Fay$$_(Prelude.map)(function($p1){var bb = $p1;return Fay$$_(Fay$$_(HTICjs.$94$$46$)(bb))(HTICjs.bname);}))(allBranches))))(Fay$$_(Fay$$_(Prelude.map)(function($p1){var bb = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.find)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(bb))(HTICjs.bname)))($gen_0);})))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.conc)(allOptionsOnDisplay)))(Fay$$_(Fay$$_(Prelude.concatMap)(function($p1){var bb = $p1;return Fay$$_(Fay$$_(HTICjs.$94$$46$)(bb))(HTICjs.bnext);}))(allBranches)));}))(allBranches))));});};};var checkIfBrancheNamesAreUnique = function($p1){return new Fay$$$(function(){var allBranches = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.nub))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(function($p1){var l = $p1;return Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(Prelude.length)(l)))(1);})))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.map)(function($p1){var n = $p1;return Fay$$_(Fay$$_(Prelude.filter)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)(n))($gen_0);}))(Fay$$_(allNames)(allBranches));})))(Fay$$_(allNames)(allBranches))));});};var allNames = function($p1){return new Fay$$$(function(){var allBranches = $p1;return Fay$$_(Fay$$_(Prelude.map)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(HTICjs.$94$$46$)($gen_0))(HTICjs.bname);}))(allBranches);});};var printNameList = function($p1){return new Fay$$$(function(){var n = $p1;var $tmp1 = (function(){var l = new Fay$$$(function(){return Fay$$_(Prelude.length)(n);});if (Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(l))(1))) {return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.putStrLn))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("not unique ")))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$_(Prelude.head)(n)))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list(" (")))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$_(Prelude.show)(l)))(Fay$$list(")"))))));} else {if (Fay$$_(Prelude.otherwise)) {return Fay$$_(Fay$$$_return)(Fay$$unit);}}})();if (undefined !== $tmp1) {return $tmp1;}});};return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Prelude.putStrLn)(Fay$$list("sanityCheck"))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var from = Fay$$index(0,Fay$$_($p1));var to = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.putStrLn))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("unreachable ")))(Fay$$_(Fay$$_(Prelude.$43$$43$)(from))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("->")))(to))));}throw ["unhandled case",$p1];})))(Fay$$_(Fay$$_(Prelude.concatMap)(checkBranch))(allBranches))))((function(){return new Fay$$$(function(){var allLinks = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.concatMap)(function($p1){var bb = $p1;return Fay$$_(Fay$$_(HTICjs.$94$$46$)(bb))(HTICjs.bnext);}))(allBranches);});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Prelude.map)(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.fromJust))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.List.stripPrefix)(Fay$$list("option_"))))(Prelude.fst))))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithValueMatchingPredicateFrom))(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Data.List.isPrefixOf)(Fay$$list("option")))($gen_0);})))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display"))))))(function($p1){var allOptionsOnDisplay = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(function($p1){var bb = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.putStrLn))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("nothing points to ")))(bb));})))(Fay$$_(Fay$$_(checkBranchReachebility)(allOptionsOnDisplay))(allBranches))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(printNameList)))(Fay$$_(checkIfBrancheNamesAreUnique)(allBranches))))(Fay$$_(Prelude.putStrLn)(Fay$$list("sanityCheck done"))));});});})()));})();});};HTICjs.initContext = function($p1){return new Fay$$$(function(){var allBranches = $p1;return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return Fay$$_(Fay$$_(HTICjs.setCbranches)(allBranches))(HTICjs.emptyContext);});return Fay$$_(Fay$$$_return)(c);});})();});};HTICjs.setDisplay = new Fay$$$(function(){return new Fay$$$(function(){var setAllowedListeners = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var allBranches = $p3;var c = $p2;var allOptions = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.hasValueSet))(Fay$$list("forbidListenersOnDisplay"))))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("cache")))))(function($p1){var forbidden = $p1;return (function($tmp1){if (Fay$$_($tmp1) === true) {return Fay$$_(Fay$$$_return)(Fay$$unit);}return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var id = Fay$$index(0,Fay$$_($p1));var o = Fay$$index(1,Fay$$_($p1));return (function(){return new Fay$$$(function(){var bb = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Data.Maybe.fromJust))(Fay$$_(Fay$$_(getBranchByName)(id))(allBranches));});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getFirstChild)(o)))(function($p1){var o = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(o))(Fay$$list("click")))(Fay$$_(Fay$$_(HTICjs.displayBranch)(c))(bb)))(true);});});})();}throw ["unhandled case",$p1];})))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(Fay$$_(idMatchesOneOfBranches)(allBranches))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.map)(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var id = Fay$$index(0,Fay$$_($p1));var o = Fay$$index(1,Fay$$_($p1));return Fay$$list([Fay$$_(Fay$$_(Prelude.$36$)(Data.Maybe.fromJust))(Fay$$_(Fay$$_(Data.List.stripPrefix)(Fay$$list("option_")))(id)),o]);}throw ["unhandled case",$p1];})))(allOptions)));})(forbidden);});});};};};var addEventListenerToPagesTop = function($p1){return function($p2){return new Fay$$$(function(){var l = $p2;var c = $p1;return Fay$$_(Fay$$_(Fay$$_(addEventListenerToPages)(c))(true))(l);});};};var addEventListenerToPagesBottom = function($p1){return function($p2){return new Fay$$$(function(){var l = $p2;var c = $p1;return Fay$$_(Fay$$_(Fay$$_(addEventListenerToPages)(c))(false))(l);});};};var addEventListenerToPages = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var l = $p3;var tb = $p2;var c = $p1;return Fay$$_(Fay$$_(Prelude.mapM_)(function($p1){var p = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(DOM.parseInt))(Data.Text.pack)))(Fay$$_(HTICjs.getInnerHtml)(p))))(function($p1){var n = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(p))(Fay$$list("click")))(Fay$$_(Fay$$_(Fay$$_(HTICjs.displayPage)(c))(Fay$$_(Fay$$_(HTICjs.scrollIntoView$39$$39$)(p))(tb)))(Fay$$_(Fay$$_(Fay$$sub)(n))(1))))(true);});}))(l);});};};};var idMatchesOneOfBranches = function($p1){return new Fay$$$(function(){var allBranches = $p1;return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Prelude.elem))(Fay$$_(Fay$$_(Prelude.map)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(HTICjs.$94$$46$)($gen_0))(HTICjs.bname);}))(allBranches))))(Prelude.fst);});};var getBranchByName = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var id = $p1;return Fay$$_(Fay$$_(Prelude.find)(function($p1){var b = $p1;return Fay$$_(Fay$$_(Fay$$eq)(id))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname));}))(b);});};};var giveAllOptions_inDisplay = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getAllWithValue_from))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")));});var head$39$ = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.Maybe.fromMaybe)(HTICjs.emptyBranch)))(Data.Maybe.listToMaybe);});return Fay$$_(Fay$$_(Fay$$bind)(HTICjs.parseAllBranches))(function($p1){var allBranches = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(HTICjs.sanityCheck)(allBranches)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.initContext)(allBranches)))(function($p1){var c = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithValueMatchingPredicateFrom))(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Data.List.isPrefixOf)(Fay$$list("option")))($gen_0);})))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))(function($p1){var allOptions = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(setAllowedListeners)(allOptions))(c))(allBranches)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(addEventListenerToPagesTop)(c)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesTop"))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(addEventListenerToPagesBottom)(c)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesBottom"))))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(e))(Fay$$list("click")))(HTICjs.removeHistory))(true);}))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("clearHistory"))))));});}));});});});HTICjs.head$39$ = function($p1){return new Fay$$$(function(){var default_ = $p1;return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.Maybe.fromMaybe)(default_)))(Data.Maybe.listToMaybe);});};HTICjs.getAllWithValue_fromDisplay = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getAllWithValue_from))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")));});HTICjs.getAllWithValue_from = function($p1){return new Fay$$$(function(){var element = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getAllWithValue_from_l))(Fay$$_(HTICjs.children_l)(element));});};HTICjs.getAllWithValue_from_l = function($p1){return new Fay$$$(function(){var list = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.map)(Prelude.snd)))(Fay$$_(Prelude.filter)(Prelude.fst)))))(Fay$$_(Fay$$_(Prelude.mapM)(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(HTICjs.hasAttribute)(e))(Fay$$list("value"))))(function($p1){var hvalue = $p1;return Fay$$_(Fay$$$_return)(Fay$$list([hvalue,e]));});}))(list));});};HTICjs.displayBranch = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var c = $p1;return (function(){var updateLastPage = new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getLastChild))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages")))))(function($p1){var last = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(HTICjs.setInnerHtml)(last)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getInnerHtml))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display"))))))(Fay$$_(Fay$$$_return)(Fay$$unit));});});var savePage = function($p1){return new Fay$$$(function(){var c = $p1;return (function(){var newPage = function($p1){return new Fay$$$(function(){var content = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.createElement$39$)(Fay$$list("div"))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(HTICjs.setInnerHtml)(e))(content)))(Fay$$_(Fay$$$_return)(e));});});};var newPageLink = function($p1){return new Fay$$$(function(){var number = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.createElement$39$)(Fay$$list("button"))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(HTICjs.setAttribute)(e))(Fay$$list("class"))))(Fay$$list("otherPage"))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(HTICjs.setInnerHtml)(e)))(Fay$$_(Prelude.show)(number))))(Fay$$_(Fay$$$_return)(e)));});});};return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages"))))(function($p1){var p = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(DOM.appendChild)(p)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(newPage))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getInnerHtml))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.childElementCount)(p)))(function($p1){var n = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(newPageLink)(n)))(function($p1){var npl = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(HTICjs.cloneNode)(npl))(true)))(function($p1){var npl$39$ = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(DOM.appendChild))(npl)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesTop")))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(DOM.appendChild))(npl$39$)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesBottom")))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(npl))(Fay$$list("click")))(Fay$$_(Fay$$_(Fay$$_(HTICjs.displayPage)(c))(Fay$$_(Fay$$_(HTICjs.scrollIntoView$39$$39$)(npl))(true)))(Fay$$_(Fay$$_(Fay$$sub)(n))(1))))(true)))(Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(npl$39$))(Fay$$list("click")))(Fay$$_(Fay$$_(Fay$$_(HTICjs.displayPage)(c))(Fay$$_(Fay$$_(HTICjs.scrollIntoView$39$$39$)(npl$39$))(false)))(Fay$$_(Fay$$_(Fay$$sub)(n))(1))))(true))));});});}));});})();});};var sp = function($p1){return function($p2){return new Fay$$$(function(){var display = $p2;var c = $p1;return (function(){var savePageAndClearIfTooBig = function($p1){return function($p2){return new Fay$$$(function(){var threshold = $p2;var h = $p1;var $tmp1 = (function(){var saveContentAndStartNewPage = new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(removeUnusedOptions))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(HTICjs.updateLeftoverAltContents)(c)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust))(HTICjs.removeElement)))(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.listToMaybe))(Prelude.reverse))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages"))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust))(HTICjs.removeElement)))(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.listToMaybe))(Prelude.reverse))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesTop"))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust))(HTICjs.removeElement)))(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.listToMaybe))(Prelude.reverse))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesBottom"))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(savePage)(c)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DOM.clearInnerHtml)(display)))(Fay$$_(savePage)(c))))))));});if (Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(h))(Fay$$_(Prelude.fromIntegral)(threshold)))) {return saveContentAndStartNewPage;} else {if (Fay$$_(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bdisplayOnNewPage))) {return saveContentAndStartNewPage;} else {if (Fay$$_(Prelude.otherwise)) {return Fay$$_(Fay$$$_return)(Fay$$unit);}}}})();if (undefined !== $tmp1) {return $tmp1;}});};};return Fay$$_(Fay$$_(Fay$$bind)(HTICjs.window_innerHeight))(function($p1){var wh = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.offsetHeight)(display)))(function($p1){var dh = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(savePageAndClearIfTooBig)(Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.fromIntegral)(dh)))(Fay$$_(Prelude.fromIntegral)(wh)))))(Fay$$_(Data.Maybe.fromMaybe)(10))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(HTICjs.getIntSetting)(Fay$$list("newPageThreshold"))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("settings")))));});});})();});};};var parseUsedUnusedOptions = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Data.List.partition)(Fay$$_(Fay$$_(Prelude.$46$)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("option_")))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname))))($gen_0);}))(Prelude.fst)))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithValueMatchingPredicateFrom))(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Data.List.isPrefixOf)(Fay$$list("option")))($gen_0);})))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display"))));});var removeUnusedOptions = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM_)(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.removeElement))(Prelude.snd))))(Prelude.snd)))(parseUsedUnusedOptions);});var removeUnusedOptions_un = new Fay$$$(function(){return Fay$$_(Prelude.mapM_)(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.removeElement))(Prelude.snd));});var sd = function($p1){return function($p2){return new Fay$$$(function(){var newContent = $p2;var c = $p1;return (function(){var wrapContent = function($p1){return function($p2){return new Fay$$$(function(){var content = $p2;var branchName = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.createElement$39$)(Fay$$list("data"))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(HTICjs.setAttribute)(e))(Fay$$list("value"))))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("content_")))(branchName))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(HTICjs.setInnerHtml)(e))(content)))(Fay$$_(Fay$$$_return)(e)));});});};};var useChosenStateIfAvailble = function($p1){return new Fay$$$(function(){var o = $p1;return (function(){var step1 = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Nothing) {return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getInnerHtml)(o)))(function($p1){var oo = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DOM.clearInnerHtml)(o)))(Fay$$_(Fay$$_(HTICjs.setInnerHtml)(o))(oo));});}if (Fay$$_($p1) instanceof Prelude._Just) {var oc = Fay$$_($p1).slot1;return Fay$$_(Fay$$_(HTICjs.setInnerHtml)(o))(oc);}throw ["unhandled case in step1",[$p1]];});};return Fay$$_(Fay$$_(Prelude.$36$)(step1))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.boptionChosenState));})();});};return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(wrapContent)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname)))(newContent)))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(parseUsedUnusedOptions))(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var usedOptions = Fay$$index(0,Fay$$_($p1));var unusedOptions = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.not))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cDontRemoveOptions)))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(removeUnusedOptions_un)(unusedOptions)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.mapM_)(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var n = Fay$$index(0,Fay$$_($p1));var o = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(HTICjs.setAttribute)(o))(Fay$$list("value"))))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("content_chosen_")))(Fay$$_(Fay$$_(Prelude.$36$)(Data.Maybe.fromJust))(Fay$$_(Fay$$_(Data.List.stripPrefix)(Fay$$list("option_")))(n))))))(Fay$$_(useChosenStateIfAvailble)(o));}throw ["unhandled case",$p1];}))(usedOptions)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM_)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.removeAttribute))(Fay$$list("id")))))(Prelude.concat)))(Fay$$_(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.children_l))(Prelude.snd)))(usedOptions)))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(DOM.appendChild))(e)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))(Fay$$_(Fay$$_(HTICjs.scrollIntoView$39$$39$)(e))(true)));}throw ["unhandled case",$p1];});});})();});};};var sdo = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var display = $p3;var b = $p2;var c = $p1;var $tmp1 = (function(){var wrapOption = function($p1){return function($p2){return new Fay$$$(function(){var content = $p2;var branchName = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.createElement$39$)(Fay$$list("data"))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(HTICjs.setAttribute)(e))(Fay$$list("value"))))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("option_")))(branchName))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(HTICjs.setInnerHtml)(e))(content)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getFirstChild)(e)))(function($p1){var f = $p1;return Fay$$_(Fay$$$_return)(e);})));});});};};var common = function($p1){return new Fay$$$(function(){var next = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(function($p1){var bb = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(wrapOption)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(bb))(HTICjs.bname))))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(bb))(HTICjs.boption))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(DOM.appendChild)(display))(e)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getFirstChild))(Fay$$_(HTICjs.getLastChild)(display))))(function($p1){var o = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(o))(Fay$$list("click")))(Fay$$_(Fay$$_(HTICjs.displayBranch)(c))(bb)))(true);}));});})))(Fay$$_(Fay$$_(Prelude.$36$)(Data.Maybe.catMaybes))(Fay$$_(Fay$$_(Prelude.map)(Fay$$_(HTICjs.getBranchByName)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cbranches))))(next)));});};if (Fay$$_(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.brandomNext))) {return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(common))(Fay$$_(Fay$$_(Prelude.$36$)(HTICjs.shuffle))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext)));} else {if (Fay$$_(Prelude.otherwise)) {return Fay$$_(Fay$$_(Prelude.$36$)(common))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext));}}})();if (undefined !== $tmp1) {return $tmp1;}});};};};var displayAlternativeContent = function($p1){return function($p2){return new Fay$$$(function(){var content = $p2;var b = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(HTICjs.setAttribute)(content))(Fay$$list("value"))))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("content_alt_")))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname)))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(HTICjs.setInnerHtml)(content)))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.fromMaybe)(Fay$$list(""))))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.baltContent)))))(updateLastPage));});};};var displayNextBranch = function($p1){return function($p2){return new Fay$$$(function(){var c = $p2;var b = $p1;return (function(){var common = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.flip)(Data.Maybe.whenJust)))(Fay$$_(HTICjs.displayBranch)(c))))(Fay$$_(HTICjs.getBranchByName)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cbranches)));});var safeHeadGo = function($p1){return function($p2){return new Fay$$$(function(){var go = $p2;var l = $p1;return Fay$$_(Fay$$_(Data.Maybe.whenJust)(Fay$$_(Data.Maybe.listToMaybe)(l)))(go);});};};return (function($tmp1){if (Fay$$_($tmp1) === false) {return Fay$$_(Fay$$_(safeHeadGo)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext)))(common);}if (Fay$$_($tmp1) === true) {return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(safeHeadGo))(common)))(Fay$$_(Fay$$_(Prelude.$36$)(HTICjs.shuffle))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext)));}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.brandomNext));})();});};};return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.clearAllAutoContinueTimers)(c)))(function($p1){var c$39$ = $p1;return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return c$39$;});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(HTICjs.overrideNext)(c))(b)))(function($p1){var b$39$ = $p1;return (function(){return new Fay$$$(function(){var b = new Fay$$$(function(){return b$39$;});return Fay$$_(Fay$$_(Fay$$bind)((function($tmp1){if (Fay$$_($tmp1) instanceof Prelude._Nothing) {return Fay$$_(Fay$$$_return)(c);}if (Fay$$_($tmp1) instanceof Prelude._Just) {return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))((function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontRemoveOptions = true;return $36$_record_to_update;})());}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bbuildFromTemplate))))(function($p1){var c$39$ = $p1;return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return c$39$;});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.whenJust)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bbuildFromTemplate))))(Fay$$_(HTICjs.buildFromTemplate)(c))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(sp)((function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontUpdateEditListener = false;return $36$_record_to_update;})())))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(sd)((function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontUpdateEditListener = false;return $36$_record_to_update;})())))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bcontent))))((function(){return new Fay$$$(function(){var c$39$ = new Fay$$$(function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontRemoveOptions = false;return $36$_record_to_update;});return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return c$39$;});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getLastChild))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))(function($p1){var lastContent = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Data.Maybe.maybeToList)))(Fay$$_(Fay$$_(Data.Maybe.whenJust$39$)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bautoContinue)))(Fay$$_(HTICjs.setTimeout$39$)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(displayNextBranch)(b)))((function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontUpdateEditListener = false;return $36$_record_to_update;})()))))))(function($p1){var act = $p1;return (function(){return new Fay$$$(function(){var c$39$ = new Fay$$$(function(){return Fay$$_(Fay$$_(HTICjs.setCautoContinueTimers)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.conc)(act)))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cAutoContinueTimers))))(c);});return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return c$39$;});return (function(){return new Fay$$$(function(){var c$39$ = new Fay$$$(function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontUpdateEditListener = false;return $36$_record_to_update;});return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return c$39$;});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(sdo)(c))(b)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))(Fay$$_(Fay$$_(Fay$$then)(updateLastPage))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.whenJust$39$)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.baltContent))))(function($p1){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(HTICjs.setTimeout$39$)(Fay$$_(Fay$$_(displayAlternativeContent)(b))(lastContent))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.fromMaybe)(5000)))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.baltContentTimeout)));})))(function($p1){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Maybe.whenJust)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.brunCode)))(HTICjs.runCode)))(Fay$$_(Fay$$$_return)(Fay$$unit));})));});})();});})();});})();});})();});});});})();});})())));});})();});});})();});});})();});})();});};};HTICjs.removeHistory = new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(DOM.clearInnerHtml))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages")))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(DOM.clearInnerHtml))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesTop")))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(DOM.clearInnerHtml))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesBottom")))));});HTICjs.removeAllEventListenersOnNode = function($p1){return new Fay$$$(function(){var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(HTICjs.cloneNode)(e))(true)))(function($p1){var t = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(HTICjs.setOuterHTML)(e)))(Fay$$_(HTICjs.getOuterHtml)(t))))(Fay$$_(HTICjs.removeElement)(t));});});};HTICjs.updateElementByIdAndOverwriteListeners = function($p1){return function($p2){return function($p3){return function($p4){return new Fay$$$(function(){var doOnEvent = $p4;var event = $p3;var content = $p2;var name = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getElementById$39$)(name)))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.setInnerHtml))(content))(e)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(HTICjs.removeAllEventListenersOnNode)(e)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getElementById$39$)(name)))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(e))(event))(doOnEvent))(true);})));});});};};};};HTICjs.updateLeftoverAltContents = function($p1){return new Fay$$$(function(){var c = $p1;return (function(){var matchElementWithBranch = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$listLen(Fay$$_($p2),2)) {var v = Fay$$index(0,Fay$$_($p2));var e = Fay$$index(1,Fay$$_($p2));var allWithAltContent = $p1;return (function(){return new Fay$$$(function(){var branch = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.find)(function($p1){var b = $p1;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(Data.List.stripPrefix)(Fay$$list("content_")))(v)))(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.Just))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname)));}))(allWithAltContent);});return Fay$$_(Fay$$$_return)(Fay$$list([v,e,branch]));});})();}throw ["unhandled case in matchElementWithBranch",[$p1,$p2]];});};};var dac = function($p1){return function($p2){return new Fay$$$(function(){var e = $p2;var b = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.$_void))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(HTICjs.setAttribute)(e))(Fay$$list("value"))))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$list("content_alt_")))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname))))))(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.$_void))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(HTICjs.setInnerHtml)(e)))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.fromMaybe)(Fay$$list(""))))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.baltContent)))));});};};return (function(){return new Fay$$$(function(){var allWithAltContent = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(function($p1){if (Fay$$_($p1) instanceof HTICjs._B) {var a = Fay$$_($p1).baltContent;return Fay$$_(Data.Maybe.isJust)(a);}throw ["unhandled case",$p1];})))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cbranches));});return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM_)(function($p1){if (Fay$$listLen(Fay$$_($p1),3)) {var e = Fay$$index(1,Fay$$_($p1));var b = Fay$$index(2,Fay$$_($p1));return Fay$$_(Fay$$_(dac)(b))(e);}throw ["unhandled case",$p1];})))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.map)(function($p1){if (Fay$$listLen(Fay$$_($p1),3)) {var _1 = Fay$$index(0,Fay$$_($p1));var _2 = Fay$$index(1,Fay$$_($p1));var _3 = Fay$$index(2,Fay$$_($p1));return Fay$$list([_1,_2,Fay$$_(Data.Maybe.fromJust)(_3)]);}throw ["unhandled case",$p1];})))(Fay$$_(Prelude.filter)(function($p1){if (Fay$$listLen(Fay$$_($p1),3)) {var _3 = Fay$$index(2,Fay$$_($p1));return Fay$$_(Data.Maybe.isJust)(_3);}throw ["unhandled case",$p1];})))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(Fay$$_(matchElementWithBranch)(allWithAltContent))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM)(function($p1){var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(function($p1){var v = $p1;return Fay$$list([v,e]);})))(Fay$$_(Fay$$_(HTICjs.getAttribute)(e))(Fay$$list("value")));})))(Prelude.concat)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM)(HTICjs.children_l)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.take)(4)))(Prelude.reverse))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages")))))));});})();})();});};HTICjs.clearAllAutoContinueTimers = function($p1){return new Fay$$$(function(){var c = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(HTICjs.clearTimeout$39$)))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cAutoContinueTimers))))((function(){return new Fay$$$(function(){var c$39$ = new Fay$$$(function(){return Fay$$_(Fay$$_(HTICjs.setCautoContinueTimers)(null))(c);});return Fay$$_(Fay$$$_return)(c$39$);});})());});};HTICjs.displayPage = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){var n = $p3;var alignScroll = $p2;var c = $p1;return (function(){var stylePages = function($p1){return function($p2){return new Fay$$$(function(){if (Fay$$listLen(Fay$$_($p2),2)) {var m = Fay$$index(0,Fay$$_($p2));var p = Fay$$index(1,Fay$$_($p2));var n = $p1;if (Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(n))(m))) {return Fay$$_(Fay$$_(Fay$$_(HTICjs.setAttribute)(p))(Fay$$list("class")))(Fay$$list("currentPage"));} else {if (Fay$$_(Prelude.otherwise)) {return Fay$$_(Fay$$_(Fay$$_(HTICjs.setAttribute)(p))(Fay$$list("class")))(Fay$$list("otherPage"));}}}throw ["unhandled case in stylePages",[$p1,$p2]];});};};return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.clearAllAutoContinueTimers)(c)))(function($p1){var c$39$ = $p1;return (function(){return new Fay$$$(function(){var c = new Fay$$$(function(){return c$39$;});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(HTICjs.updateLeftoverAltContents)(c)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.getInnerHtml))(Fay$$_(Fay$$_(Prelude.flip)(Prelude.$33$$33$))(n))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages"))))))(function($p1){var p = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM_)(Fay$$_(stylePages)(n))))(Fay$$_(Prelude.zip)(Prelude.enumFrom(0)))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesTop"))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM_)(Fay$$_(stylePages)(n))))(Fay$$_(Prelude.zip)(Prelude.enumFrom(0)))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pagesBottom"))))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.setInnerHtml))(p)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("display")))))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.childElementCount))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("pages")))))(function($p1){var totalPages = $p1;return Fay$$_(Fay$$_(Fay$$then)((function($tmp1){if (Fay$$_($tmp1) === false) {return HTICjs.setForbidListenersOnDisplay;}if (Fay$$_($tmp1) === true) {return Fay$$_(Fay$$_(Fay$$then)(HTICjs.unsetForbidListenersOnDisplay))(HTICjs.setDisplay);}return (function(){ throw (["unhandled case",$tmp1]); })();})(Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(Fay$$add)(n))(1)))(totalPages))))(alignScroll);}))));}));});})();});})();});};};};HTICjs.setForbidListenersOnDisplay = new Fay$$$(function(){return Fay$$_(HTICjs.setParamSetting)(Fay$$list("forbidListenersOnDisplay"));});HTICjs.unsetForbidListenersOnDisplay = new Fay$$$(function(){return Fay$$_(HTICjs.unsetSettingByValue)(Fay$$list("forbidListenersOnDisplay"));});HTICjs.setParamSetting = function($p1){return new Fay$$$(function(){var setting = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.createElement$39$)(Fay$$list("param"))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(HTICjs.setAttribute)(e))(Fay$$list("value")))(setting)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(DOM.appendChild))(e)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("cache"))));});});};HTICjs.unsetSettingByValue = function($p1){return new Fay$$$(function(){var setting = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getAllWithValue_from))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("cache")))))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAttribute))(Fay$$list("value"))))(e)))(function($p1){var v = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.removeElement))(Prelude.snd))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(Fay$$_(Fay$$_(Prelude.$46$)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)(setting))($gen_0);}))(Prelude.fst))))(Fay$$_(Fay$$_(Prelude.zip)(v))(e)));});});});};HTICjs.peaceTogetherOptions = function($p1){return new Fay$$$(function(){var bs = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.unlines))(Fay$$_(Fay$$_(Prelude.map)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(HTICjs.$94$$46$)($gen_0))(HTICjs.boption);}))(bs));});};HTICjs.getBranchByName = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var bs = $p1;return Fay$$_(Fay$$_(Prelude.find)(function($p1){var b = $p1;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bname)))(v);}))(bs);});};};HTICjs.getBranchByNameDOM = function($p1){return new Fay$$$(function(){var name = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Data.Maybe.listToMaybe)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom))(name)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("data"))));});};HTICjs.hasValueSet = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Prelude.any)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)($gen_0))(v);}))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAttribute))(Fay$$list("value")))))(Fay$$_(HTICjs.getAllWithValue_from)(e)));});};};HTICjs.hasValueSet_l = function($p1){return function($p2){return new Fay$$$(function(){var v = $p2;var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Prelude.any)(function($p1){var $gen_0 = $p1;return Fay$$_(Fay$$_(Fay$$eq)($gen_0))(v);}))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAttribute))(Fay$$list("value")))))(Fay$$_(HTICjs.getAllWithValue_from_l)(e)));});};};HTICjs.buildFromTemplate = function($p1){return function($p2){return new Fay$$$(function(){var t = $p2;var c = $p1;return (function(){var dbl = function($p1){return new Fay$$$(function(){var c = $p1;return Fay$$_(Prelude.repeat)(Fay$$_(HTICjs.displayBranch)(c));});};var perPair = function($p1){return new Fay$$$(function(){if (Fay$$listLen(Fay$$_($p1),2)) {if (Fay$$equal(Fay$$index(0,Fay$$_($p1)),Fay$$list("data"))) {var byValue = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))(Fay$$_(Fay$$_(HTICjs.getBranchByName)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cbranches)))(byValue));}}if (Fay$$listLen(Fay$$_($p1),2)) {var containerID = Fay$$index(0,Fay$$_($p1));var byValue = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.Just))(Fay$$_(Fay$$_(Prelude.$46$)(function($p1){var c = $p1;return (function(){var $36$_record_to_update = Object.create(Fay$$_(HTICjs.emptyBranch));$36$_record_to_update.bcontent = c;return $36$_record_to_update;})();}))(Prelude.unlines)))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.getInnerHtml))(Prelude.snd))))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom))(byValue)))(Fay$$_(HTICjs.getElementById$39$)(containerID))));}throw ["unhandled case in perPair",[$p1]];});};return (function(){return new Fay$$$(function(){var cDRO = new Fay$$$(function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontRemoveOptions = true;return $36$_record_to_update;});return (function(){return new Fay$$$(function(){var cRO = new Fay$$$(function(){var $36$_record_to_update = Object.create(Fay$$_(c));$36$_record_to_update.cDontRemoveOptions = false;return $36$_record_to_update;});return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(function($p1){var pp = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM_)(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var l = Fay$$index(0,Fay$$_($p1));var r = Fay$$index(1,Fay$$_($p1));return Fay$$_(l)(r);}throw ["unhandled case",$p1];})))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.zip)(Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(HTICjs.displayBranch)(cRO)))(Fay$$_(dbl)(cDRO)))))(Fay$$_(Data.Maybe.catMaybes)(pp)));}))(Fay$$_(Fay$$_(Prelude.mapM)(perPair))(t));});})();});})();})();});};};HTICjs.overrideNext = function($p1){return function($p2){return new Fay$$$(function(){var b = $p2;var c = $p1;return (function(){var perBranchSkip = function($p1){return function($p2){return new Fay$$$(function(){var next = $p2;if (Fay$$_($p1) === null) {return next;}var next = $p2;var $tmp1 = Fay$$_($p1);if ($tmp1 instanceof Fay$$Cons) {var option = $tmp1.car;var rest = $tmp1.cdr;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(Prelude.maybe)(next))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(perBranchSkipContinue)(rest))(next)))(function($p1){var b = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(takeNth)(option)))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext));}))))(Fay$$_(Fay$$_(HTICjs.getBranchByName)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(c))(HTICjs.cbranches)))(next));}throw ["unhandled case in perBranchSkip",[$p1,$p2]];});};};var takeNth = function($p1){return function($p2){return new Fay$$$(function(){var l = $p2;var n = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(safeHead))(Fay$$_(Fay$$_(Prelude.drop)(n))(l));});};};var safeHead = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === null) {return Prelude.Nothing;}var l = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.Just))(Fay$$_(Prelude.head)(l));});};var perBranchSkipContinue = function($p1){return function($p2){return function($p3){return new Fay$$$(function(){if (Fay$$_($p3) instanceof Prelude._Nothing) {var next = $p2;var rest = $p1;return next;}if (Fay$$_($p3) instanceof Prelude._Just) {var newnext = Fay$$_($p3).slot1;var next = $p2;var rest = $p1;return Fay$$_(Fay$$_(perBranchSkip)(rest))(newnext);}throw ["unhandled case in perBranchSkipContinue",[$p1,$p2,$p3]];});};};};return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.Maybe.fromMaybe)(b)))(Data.Maybe.joinMaybe))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.whenJust$39$)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.boverrideNext))))(function($p1){var on = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust$39$))(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var el = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(function($p1){var n = $p1;return (function(){var $36$_record_to_update = Object.create(Fay$$_(b));$36$_record_to_update.bnext = n;return $36$_record_to_update;})();})))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(function($p1){var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Data.Text.unpack)))(Fay$$_(DOM.getValue)(e));})))(Fay$$_(HTICjs.children_l)(el)));}throw ["unhandled case",$p1];})))(Data.Maybe.listToMaybe)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom))(on)))(Fay$$_(HTICjs.getElementById$39$)(Fay$$list("cache"))));}))))(function($p1){var b$39$ = $p1;return (function($tmp1){if (Fay$$_($tmp1) === null) {return Fay$$_(Fay$$$_return)(b);}return (function(){return new Fay$$$(function(){var b = new Fay$$$(function(){return b$39$;});return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))(Fay$$_(Fay$$_(Prelude.$36$)(function($p1){var n = $p1;return (function(){var $36$_record_to_update = Object.create(Fay$$_(b));$36$_record_to_update.bnext = n;return $36$_record_to_update;})();}))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.map)(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var next = Fay$$index(0,Fay$$_($p1));var skips = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(perBranchSkip)(skips))(next);}throw ["unhandled case",$p1];})))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.zip)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bnext))))(Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b))(HTICjs.bskipPastNext)))(Fay$$_(Prelude.repeat)(null))))));});})();})(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(function($p1){var s = $p1;return Fay$$_(Fay$$_(Fay$$neq)(Fay$$_(Fay$$_(Prelude.filter)(function($p1){var x = $p1;return Fay$$_(Fay$$_(Fay$$neq)(x))(" ");}))(s)))(Fay$$list(""));})))(Fay$$_(Fay$$_(HTICjs.$94$$46$)(b$39$))(HTICjs.bnext)));});})();});};};HTICjs.parseBranch = function($p1){return new Fay$$$(function(){var e = $p1;return (function(){var parseNext = function($p1){return new Fay$$$(function(){var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Data.Text.unpack)))(Fay$$_(DOM.getValue)(e));});};var head$39$ = new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.Maybe.fromMaybe)(Fay$$_(DOM.createTextNode)(Fay$$list("")))))(Fay$$_(Fay$$_(Prelude.$46$)(Data.Maybe.listToMaybe))(Fay$$_(Prelude.map)(Fay$$$_return)));});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Data.Text.unpack)))(Fay$$_(DOM.getValue)(e))))(function($p1){var nn = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getInnerHtml))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(head$39$))(Fay$$_(HTICjs.children_l)(e)))))(function($p1){var o = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.getInnerHtml))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(head$39$))(Fay$$_(Prelude.drop)(1))))(Fay$$_(HTICjs.children_l)(e)))))(function($p1){var c = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(parseNext)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.children_l))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(head$39$))(Fay$$_(Prelude.drop)(2))))(Fay$$_(HTICjs.children_l)(e))))))(function($p1){var n = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.hasValueSet_l))(Fay$$list("displayOnNewPage"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var d = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getStringSetting)(Fay$$list("altContent"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var ac = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getIntSetting)(Fay$$list("altContentTimeout"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var act = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getIntSetting)(Fay$$list("autoContinue"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var s = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.hasValueSet_l))(Fay$$list("randomNext"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var r = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getMapSetting)(Fay$$list("buildFromTemplate"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var b = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getStringSetting)(Fay$$list("overrideNext"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var on = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(HTICjs.toSkipPastNextSetting))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getStringSetting)(Fay$$list("skipPastNext"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e)))))(function($p1){var spn = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getStringSetting)(Fay$$list("runCode"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var rnc = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(HTICjs.getStringSetting)(Fay$$list("optionChosenState"))))(Fay$$_(Prelude.drop)(3))))(Fay$$_(HTICjs.children_l)(e))))(function($p1){var oc = $p1;return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))((function(){var _b = new HTICjs._B();_b.bname = nn;_b.boption = o;_b.boptionChosenState = oc;_b.bcontent = c;_b.bnext = n;_b.bdisplayOnNewPage = d;_b.bautoContinue = s;_b.baltContent = ac;_b.baltContentTimeout = act;_b.brandomNext = r;_b.bbuildFromTemplate = b;_b.boverrideNext = on;_b.bskipPastNext = spn;_b.brunCode = rnc;return _b;})());});});});});});});});});});});});});});});})();});};HTICjs.getStringSetting = function($p1){return function($p2){return new Fay$$$(function(){var list = $p2;var setting = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust$39$))(Fay$$_(Fay$$_(Prelude.$46$)(HTICjs.getInnerHtml))(Prelude.snd))))(Data.Maybe.listToMaybe)))(Fay$$_(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom_l))(setting))(list));});};};HTICjs.getIntSetting = function($p1){return function($p2){return new Fay$$$(function(){var list = $p2;var setting = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust$39$))(function($p1){if (Fay$$listLen(Fay$$_($p1),2)) {var e = Fay$$index(1,Fay$$_($p1));return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(DOM.parseInt))(Data.Text.pack)))(Fay$$_(HTICjs.getInnerHtml)(e));}throw ["unhandled case",$p1];})))(Data.Maybe.listToMaybe)))(Fay$$_(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom_l))(setting))(list));});};};HTICjs.getMapSetting = function($p1){return function($p2){return new Fay$$$(function(){var list = $p2;var setting = $p1;return (function(){var perPair = function($p1){return new Fay$$$(function(){var e = $p1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DOM.getValue)(e)))(function($p1){var v$39$ = $p1;return (function(){return new Fay$$$(function(){var v = new Fay$$$(function(){return Fay$$_(Data.Text.unpack)(v$39$);});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(HTICjs.getInnerHtml)(e)))(function($p1){var i$39$ = $p1;return (function(){return new Fay$$$(function(){var i = new Fay$$$(function(){return i$39$;});return Fay$$_(Fay$$$_return)(Fay$$list([v,i]));});})();});});})();});});};return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Fay$$_(Prelude.flip)(Data.Maybe.whenJust$39$))(function($p1){var e = $p1;return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(perPair)))(Fay$$_(Fay$$_(Prelude.$36$)(HTICjs.children_l))(Fay$$_(Prelude.snd)(e)));})))(Data.Maybe.listToMaybe)))(Fay$$_(Fay$$_(Fay$$_(Prelude.flip)(HTICjs.getAllWithGivenValueFrom_l))(setting))(list));})();});};};HTICjs.toSkipPastNextSetting = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) instanceof Prelude._Nothing) {return Fay$$_(Fay$$$_return)(null);}if (Fay$$_($p1) instanceof Prelude._Just) {if (Fay$$equal(Fay$$_($p1).slot1,Fay$$list(""))) {return Fay$$_(Fay$$$_return)(null);}}if (Fay$$_($p1) instanceof Prelude._Just) {var s = Fay$$_($p1).slot1;return (function(){var commasToSpaces = function($p1){return new Fay$$$(function(){if (Fay$$_($p1) === ",") {return " ";}var x = $p1;return x;});};return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Prelude.mapM)(Fay$$_(Fay$$_(Prelude.$46$)(DOM.parseInt))(Data.Text.pack))))(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.words))(Fay$$_(Prelude.map)(commasToSpaces))))))(Fay$$_(Prelude.words)(s));})();}throw ["unhandled case in toSkipPastNextSetting",[$p1]];});};HTICjs.parseAllBranches = new Fay$$$(function(){return new Fay$$$(function(){var jsAllBranches = new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document.getElementById("data")));});return Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Prelude.mapM)(HTICjs.parseBranch)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(DOM.nodeListToArray)))(Fay$$_(Fay$$_(Prelude.$61$$60$$60$)(DOM.children))(jsAllBranches)));});});HTICjs.main = new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(DOM.getWindow))(function($p1){var w = $p1;return Fay$$_(Fay$$_(Fay$$_(Fay$$_(HTICjs.addEventListener)(w))(Fay$$list("load")))(HTICjs.setDisplay))(true);});});Fay$$objConcat(Fay$$fayToJsHash,{"B": function(type,argTypes,_obj){var obj_ = {"instance": "B"};var obj_bname = Fay$$fayToJs_string(_obj.bname);if (undefined !== obj_bname) {obj_['bname'] = obj_bname;}var obj_boption = Fay$$fayToJs_string(_obj.boption);if (undefined !== obj_boption) {obj_['boption'] = obj_boption;}var obj_boptionChosenState = Fay$$fayToJs(["user","Maybe",[["string"]]],_obj.boptionChosenState);if (undefined !== obj_boptionChosenState) {obj_['boptionChosenState'] = obj_boptionChosenState;}var obj_bcontent = Fay$$fayToJs_string(_obj.bcontent);if (undefined !== obj_bcontent) {obj_['bcontent'] = obj_bcontent;}var obj_bnext = Fay$$fayToJs(["list",[["string"]]],_obj.bnext);if (undefined !== obj_bnext) {obj_['bnext'] = obj_bnext;}var obj_bdisplayOnNewPage = Fay$$fayToJs_bool(_obj.bdisplayOnNewPage);if (undefined !== obj_bdisplayOnNewPage) {obj_['bdisplayOnNewPage'] = obj_bdisplayOnNewPage;}var obj_bautoContinue = Fay$$fayToJs(["user","Maybe",[["int"]]],_obj.bautoContinue);if (undefined !== obj_bautoContinue) {obj_['bautoContinue'] = obj_bautoContinue;}var obj_baltContent = Fay$$fayToJs(["user","Maybe",[["string"]]],_obj.baltContent);if (undefined !== obj_baltContent) {obj_['baltContent'] = obj_baltContent;}var obj_baltContentTimeout = Fay$$fayToJs(["user","Maybe",[["int"]]],_obj.baltContentTimeout);if (undefined !== obj_baltContentTimeout) {obj_['baltContentTimeout'] = obj_baltContentTimeout;}var obj_brandomNext = Fay$$fayToJs_bool(_obj.brandomNext);if (undefined !== obj_brandomNext) {obj_['brandomNext'] = obj_brandomNext;}var obj_bbuildFromTemplate = Fay$$fayToJs(["user","Maybe",[["list",[["tuple",[["string"],["string"]]]]]]],_obj.bbuildFromTemplate);if (undefined !== obj_bbuildFromTemplate) {obj_['bbuildFromTemplate'] = obj_bbuildFromTemplate;}var obj_boverrideNext = Fay$$fayToJs(["user","Maybe",[["string"]]],_obj.boverrideNext);if (undefined !== obj_boverrideNext) {obj_['boverrideNext'] = obj_boverrideNext;}var obj_bskipPastNext = Fay$$fayToJs(["list",[["list",[["int"]]]]],_obj.bskipPastNext);if (undefined !== obj_bskipPastNext) {obj_['bskipPastNext'] = obj_bskipPastNext;}var obj_brunCode = Fay$$fayToJs(["user","Maybe",[["string"]]],_obj.brunCode);if (undefined !== obj_brunCode) {obj_['brunCode'] = obj_brunCode;}return obj_;},"C": function(type,argTypes,_obj){var obj_ = {"instance": "C"};var obj_cbranches = Fay$$fayToJs(["list",[["user","Branch",[]]]],_obj.cbranches);if (undefined !== obj_cbranches) {obj_['cbranches'] = obj_cbranches;}var obj_cAutoContinueTimers = Fay$$fayToJs(["list",[["user","Timer",[]]]],_obj.cAutoContinueTimers);if (undefined !== obj_cAutoContinueTimers) {obj_['cAutoContinueTimers'] = obj_cAutoContinueTimers;}var obj_cEdit = Fay$$fayToJs(["user","Branch",[]],_obj.cEdit);if (undefined !== obj_cEdit) {obj_['cEdit'] = obj_cEdit;}var obj_cDontUpdateEditListener = Fay$$fayToJs_bool(_obj.cDontUpdateEditListener);if (undefined !== obj_cDontUpdateEditListener) {obj_['cDontUpdateEditListener'] = obj_cDontUpdateEditListener;}var obj_cDontRemoveOptions = Fay$$fayToJs_bool(_obj.cDontRemoveOptions);if (undefined !== obj_cDontRemoveOptions) {obj_['cDontRemoveOptions'] = obj_cDontRemoveOptions;}return obj_;}});Fay$$objConcat(Fay$$jsToFayHash,{"B": function(type,argTypes,obj){return new HTICjs._B(Fay$$jsToFay_string(obj["bname"]),Fay$$jsToFay_string(obj["boption"]),Fay$$jsToFay(["user","Maybe",[["string"]]],obj["boptionChosenState"]),Fay$$jsToFay_string(obj["bcontent"]),Fay$$jsToFay(["list",[["string"]]],obj["bnext"]),Fay$$jsToFay_bool(obj["bdisplayOnNewPage"]),Fay$$jsToFay(["user","Maybe",[["int"]]],obj["bautoContinue"]),Fay$$jsToFay(["user","Maybe",[["string"]]],obj["baltContent"]),Fay$$jsToFay(["user","Maybe",[["int"]]],obj["baltContentTimeout"]),Fay$$jsToFay_bool(obj["brandomNext"]),Fay$$jsToFay(["user","Maybe",[["list",[["tuple",[["string"],["string"]]]]]]],obj["bbuildFromTemplate"]),Fay$$jsToFay(["user","Maybe",[["string"]]],obj["boverrideNext"]),Fay$$jsToFay(["list",[["list",[["int"]]]]],obj["bskipPastNext"]),Fay$$jsToFay(["user","Maybe",[["string"]]],obj["brunCode"]));},"C": function(type,argTypes,obj){return new HTICjs._C(Fay$$jsToFay(["list",[["user","Branch",[]]]],obj["cbranches"]),Fay$$jsToFay(["list",[["user","Timer",[]]]],obj["cAutoContinueTimers"]),Fay$$jsToFay(["user","Branch",[]],obj["cEdit"]),Fay$$jsToFay_bool(obj["cDontUpdateEditListener"]),Fay$$jsToFay_bool(obj["cDontRemoveOptions"]));}});Fay$$_(HTICjs.main, true);









window.addEventListener('load', autostart, false);



</script>
<noscript>Your browser does not support JavaScript!</noscript>
</body></html>
